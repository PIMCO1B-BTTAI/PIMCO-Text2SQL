Test_Din Output Log
================================================================================
Ground Truth Query: WITH MaturityDiversity AS (
    SELECT 
        F.SERIES_NAME,
        COUNT(DISTINCT 
            CASE 
                WHEN DS.MATURITY_DATE <= DATE('now', '+1 year') THEN 'SHORT_TERM'
                WHEN DS.MATURITY_DATE <= DATE('now', '+5 year') THEN 'MEDIUM_TERM'
                ELSE 'LONG_TERM'
            END
        ) as Maturity_Types,
        COUNT(*) as Total_Debt_Securities
    FROM 
        FUND_REPORTED_INFO F
        JOIN FUND_REPORTED_HOLDING H 
            ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
        JOIN DEBT_SECURITY DS 
            ON H.HOLDING_ID = DS.HOLDING_ID
    WHERE 
        DS.MATURITY_DATE IS NOT NULL
    GROUP BY 
        F.SERIES_NAME
)
SELECT 
    SERIES_NAME,
    Maturity_Types,
    Total_Debt_Securities,
    (Maturity_Types * 100.0 / 3) as Diversity_Score
FROM 
    MaturityDiversity
WHERE 
    Total_Debt_Securities >= 5
ORDER BY 
    Maturity_Types DESC, 
    Total_Debt_Securities DESC;
================================================================================
Schema Links for Question: Show me which funds have the most diverse debt security holdings by maturity
{'table_columns': ['debt_security.maturity_date', 'fund_reported_info.assets_attrbt_to_misc_security', 'securities_lending.is_loan_by_fund', 'debt_security_ref_instrument.debt_security_ref_id', 'fund_reported_holding.holding_id'], 'primary_keys': ['FUND_REPORTED_INFO.ACCESSION_NUMBER', 'FUND_REPORTED_HOLDING.ACCESSION_NUMBER', 'FUND_REPORTED_HOLDING.HOLDING_ID', 'DEBT_SECURITY_REF_INSTRUMENT.HOLDING_ID', 'DEBT_SECURITY_REF_INSTRUMENT.DEBT_SECURITY_REF_ID', 'SECURITIES_LENDING.HOLDING_ID'], 'foreign_keys': ['REGISTRANT.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'INTEREST_RATE_RISK.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'BORROWER.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'BORROW_AGGREGATE.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'MONTHLY_TOTAL_RETURN.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'MONTHLY_RETURN_CAT_INSTRUMENT.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'FUND_VAR_INFO.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'FUND_REPORTED_HOLDING.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'EXPLANATORY_NOTE.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'SUBMISSION.ACCESSION_NUMBER = FUND_REPORTED_INFO.ACCESSION_NUMBER', 'IDENTIFIERS.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DEBT_SECURITY.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DEBT_SECURITY_REF_INSTRUMENT.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'CONVERTIBLE_SECURITY_CURRENCY.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'REPURCHASE_AGREEMENT.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'REPURCHASE_COUNTERPARTY.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'REPURCHASE_COLLATERAL.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DERIVATIVE_COUNTERPARTY.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'SWAPTION_OPTION_WARNT_DERIV.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DESC_REF_INDEX_BASKET.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DESC_REF_INDEX_COMPONENT.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'DESC_REF_OTHER.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'FUT_FWD_NONFOREIGNCUR_CONTRACT.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'FWD_FOREIGNCUR_CONTRACT_SWAP.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'NONFOREIGN_EXCHANGE_SWAP.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'FLOATING_RATE_RESET_TENOR.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'OTHER_DERIV.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'OTHER_DERIV_NOTIONAL_AMOUNT.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID', 'SECURITIES_LENDING.HOLDING_ID = FUND_REPORTED_HOLDING.HOLDING_ID']}
================================================================================
classification reasoning: To determine which funds have the most diverse debt security holdings by maturity, we need to analyze the maturity dates of debt securities held by each fund. This involves the following steps:

1. **Identify Relevant Tables**: 
   - We need information from the `DEBT_SECURITY` table to access the `MATURITY_DATE` of each debt security.
   - We also need to link this information to the `FUND_REPORTED_HOLDING` table to identify which fund holds each security.

2. **Join Tables**:
   - We need to join the `DEBT_SECURITY` table with the `FUND_REPORTED_HOLDING` table using the `HOLDING_ID` as the foreign key to link debt securities to their respective funds.

3. **Aggregate and Analyze**:
   - We need to count the number of unique maturity dates for each fund to determine the diversity of their debt security holdings.
   - This requires grouping the results by fund and counting distinct maturity dates.

4. **Determine the Most Diverse Holdings**:
   - Finally, we need to sort the results to find the funds with the highest count of unique maturity dates.

Given these steps, the query involves joining tables and performing aggregation, but it does not require nested queries. Therefore, the SQL query can be classified as "NON-NESTED."

Label: "NON-NESTED"
================================================================================
classification: "NON-NESTED"
================================================================================
process_thesql: ```sql
SELECT fri.ACCESSION_NUMBER, COUNT(DISTINCT ds.MATURITY_DATE) AS diversity_count
FROM FUND_REPORTED_INFO fri
JOIN FUND_REPORTED_HOLDING frh ON fri.ACCESSION_NUMBER = frh.ACCESSION_NUMBER
JOIN DEBT_SECURITY ds ON frh.HOLDING_ID = ds.HOLDING_ID
GROUP BY fri.ACCESSION_NUMBER
ORDER BY diversity_count DESC;
```

This query will provide a list of funds ordered by the diversity of their debt security holdings based on distinct maturity dates.
================================================================================
final_output: 
SELECT fri.ACCESSION_NUMBER, COUNT(DISTINCT ds.MATURITY_DATE) AS diversity_count
FROM FUND_REPORTED_INFO fri
JOIN FUND_REPORTED_HOLDING frh ON fri.ACCESSION_NUMBER = frh.ACCESSION_NUMBER
JOIN DEBT_SECURITY ds ON frh.HOLDING_ID = ds.HOLDING_ID
GROUP BY fri.ACCESSION_NUMBER
ORDER BY diversity_count DESC
================================================================================
Result: False
================================================================================
