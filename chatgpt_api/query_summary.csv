"Question","SQL","Result_Count","Status"
"Show me the top 20 largest funds by total assets","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 20;","20","Success"
"List all funds with net assets over 1 billion dollars","SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(NET_ASSETS AS FLOAT) > 1000000000;","1652","Success"
"Which asset categories have the highest total investment value?","SELECT 
    ASSET_CAT,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING
GROUP BY 
    ASSET_CAT
ORDER BY 
    Total_Value DESC
LIMIT 1;","0","Failed: no such column: Total_Value"
"Show me the largest bond funds","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%BOND%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me the phone numbers of all Vanguard registrants","SELECT 
    REGISTRANT_NAME,
    PHONE 
FROM 
    REGISTRANT 
WHERE 
    REGISTRANT_NAME LIKE '%VANGUARD%';","119","Success"
"Which funds have assets between 100M and 500M?","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(TOTAL_ASSETS AS FLOAT) BETWEEN 100000000 AND 500000000;","1145","Success"
"List all registrants and their cities","SELECT 
    REGISTRANT_NAME,
    CITY
FROM 
    REGISTRANT;","4223","Success"
"Which funds have total assets equal to net assets?","SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS = NET_ASSETS;","2","Success"
"List all funds with 'Income' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INCOME%';","560","Success"
"Which funds have the highest liabilities to assets ratio?","SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS != '0'
ORDER BY 
    Liability_Ratio DESC
LIMIT 1;","0","Failed: no such column: Liability_Ratio"
"Show me all funds with 'Growth' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%GROWTH%';","407","Success"
"List the top 10 funds by net assets","SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
ORDER BY 
    CAST(NET_ASSETS AS FLOAT) DESC 
LIMIT 10;","10","Success"
"Which funds have zero liabilities?","SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;","2","Success"
"Which funds have the most cash on hand?","SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me the smallest 5 funds by total assets","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS IS NOT NULL
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) ASC 
LIMIT 5;","5","Success"
"Which registrants have multiple phone numbers?","SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT PHONE)
FROM 
    REGISTRANT
GROUP BY 
    REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT PHONE) > 1;","6","Success"
"Show me all registrants from Florida","SELECT 
    REGISTRANT_NAME,
    CITY,
    ADDRESS1 
FROM 
    REGISTRANT 
WHERE 
    STATE = 'FL';","0","Success"
"Show me funds with the highest ratio of cash to total assets","SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL 
    AND TOTAL_ASSETS > 0
ORDER BY 
    Cash_Percentage DESC
LIMIT 1;","0","Failed: no such column: Cash_Percentage"
"List all funds with 'Index' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INDEX%';","367","Success"
"List all registrants with their ZIP codes","SELECT 
    REGISTRANT_NAME,
    ZIP
FROM 
    REGISTRANT;","4223","Success"
"Show me all equity-focused funds","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%EQUITY%'
    OR SERIES_NAME LIKE '%STOCK%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC;","476","Success"
"List all registrants with their country","SELECT 
    REGISTRANT_NAME,
    COUNTRY
FROM 
    REGISTRANT;","4223","Success"
"I'm looking for any funds with 'sustainable' or 'ESG' in their name what's their total AUM?","SELECT 
    COUNT(*),
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%SUSTAINABLE%'
    OR SERIES_NAME LIKE '%ESG%';","1","Success"
"Could you check which states have the most fund registrants? Top 5 is fine.","SELECT 
    STATE,
    COUNT(DISTINCT REGISTRANT_NAME)
FROM 
    REGISTRANT
GROUP BY 
    STATE
ORDER BY 
    Registrant_Count DESC
LIMIT 5;","0","Failed: no such column: Registrant_Count"
"Find me funds that might be taking on too much credit risk - look at their non-investment grade holdings","SELECT 
    F.SERIES_NAME,
    SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)),
    SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.CREDIT_SPREAD_10YR_NONINVEST IS NOT NULL
GROUP BY 
    F.SERIES_NAME
HAVING 
    NonInvest_Exposure > Invest_Exposure
ORDER BY 
    NonInvest_Exposure DESC;","0","Failed: no such column: NonInvest_Exposure"
"Show me the funds with the highest quality fixed income portfolios","SELECT 
    F.SERIES_NAME,
    CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) / 
    NULLIF(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) + CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%FIXED INCOME%'
ORDER BY 
    Investment_Grade_Ratio DESC
LIMIT 1;","0","Failed: no such column: Investment_Grade_Ratio"
"Looking for funds that might have liquidity issues - check their cash versus short-term obligations","SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / NULLIF(CAST(BORROWING_PAY_WITHIN_1YR AS FLOAT), 0),
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO
WHERE 
    BORROWING_PAY_WITHIN_1YR > 0
ORDER BY 
    Cash_Coverage_Ratio ASC;","0","Failed: no such column: Cash_Coverage_Ratio"
"Find funds with the highest quality fixed-income holdings","SELECT 
    F.SERIES_NAME,
    CAST(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) AS FLOAT) /
    NULLIF(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%FIXED INCOME%'
GROUP BY 
    F.SERIES_NAME
HAVING 
    SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)) > 0
ORDER BY 
    NULLIF(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)), 0) * 100 DESC
LIMIT 1;","1","Success"
"Find funds that might be too leveraged through their borrowing activities","SELECT 
    F.SERIES_NAME,
    (CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT) +
     CAST(F.BORROWING_PAY_AFTER_1YR AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.TOTAL_ASSETS > 0
ORDER BY 
    Leverage_Ratio DESC;","0","Failed: no such column: Leverage_Ratio"
"How has the average fund size changed over the last few quarters?","SELECT 
    QUARTER,
    COUNT(DISTINCT SERIES_NAME),
    AVG(CAST(TOTAL_ASSETS AS FLOAT)),
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"Show quarterly trends in credit quality for fixed income funds","SELECT 
    QUARTER,
    AVG(CAST(CREDIT_SPREAD_10YR_INVEST AS FLOAT)),
    AVG(CAST(CREDIT_SPREAD_10YR_NONINVEST AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    CREDIT_SPREAD_10YR_INVEST IS NOT NULL 
    OR CREDIT_SPREAD_10YR_NONINVEST IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"How has average fund leverage changed quarter by quarter?","SELECT 
    QUARTER,
    AVG(CAST(BORROWING_PAY_WITHIN_1YR AS FLOAT) + CAST(BORROWING_PAY_AFTER_1YR AS FLOAT)),
    COUNT(DISTINCT SERIES_NAME)
FROM 
    FUND_REPORTED_INFO
WHERE 
    BORROWING_PAY_WITHIN_1YR IS NOT NULL 
    OR BORROWING_PAY_AFTER_1YR IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"Show the evolution of debt security maturity profiles by quarter","SELECT 
    QUARTER,
    COUNT(CASE WHEN MATURITY_DATE <= DATE('now', '+1 year') THEN 1 END) AS Short_Term,
    COUNT(CASE WHEN MATURITY_DATE > DATE('now', '+1 year') 
               AND MATURITY_DATE <= DATE('now', '+5 year') THEN 1 END) AS Medium_Term,
    COUNT(CASE WHEN MATURITY_DATE > DATE('now', '+5 year') THEN 1 END) AS Long_Term
FROM 
    DEBT_SECURITY
WHERE 
    MATURITY_DATE IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"What's the quarterly pattern of fund cash positions?","SELECT 
    QUARTER,
    AVG(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS Avg_Cash_Position,
    MAX(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS Max_Cash_Position,
    MIN(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS Min_Cash_Position
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"What percentage of funds in each quarter have total assets over $1 billion?","SELECT 
    QUARTER,
    COUNT(*),
    COUNT(CASE WHEN CAST(TOTAL_ASSETS AS FLOAT) > 1000000000 THEN 1 END),
    (COUNT(CASE WHEN CAST(TOTAL_ASSETS AS FLOAT) > 1000000000 THEN 1 END) * 100.0 / COUNT(*))
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS IS NOT NULL
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","1","Success"
"Can you flag any funds that have liabilities over half their assets?","SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) * 100,
    TOTAL_ASSETS,
    TOTAL_LIABILITIES
FROM 
    FUND_REPORTED_INFO
WHERE 
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) > 0.5;","53","Success"
"Find any funds showing losses in their realized gains.","SELECT 
    F.SERIES_NAME,
    F.NET_REALIZE_GAIN_NONDERIV_MON1,
    F.NET_REALIZE_GAIN_NONDERIV_MON2,
    F.NET_REALIZE_GAIN_NONDERIV_MON3,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
WHERE 
    CAST(NET_REALIZE_GAIN_NONDERIV_MON1 AS FLOAT) < 0
    OR CAST(NET_REALIZE_GAIN_NONDERIV_MON2 AS FLOAT) < 0
    OR CAST(NET_REALIZE_GAIN_NONDERIV_MON3 AS FLOAT) < 0;","2500","Success"
"Give me a breakdown of holdings by fair value level and issuer type looking for valuation risk.","SELECT 
    ISSUER_TYPE,
    FAIR_VALUE_LEVEL,
    COUNT(*),
    SUM(CAST(CURRENCY_VALUE AS FLOAT)),
    COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY ISSUER_TYPE)
FROM 
    FUND_REPORTED_HOLDING
WHERE 
    ISSUER_TYPE IS NOT NULL 
    AND FAIR_VALUE_LEVEL IS NOT NULL
GROUP BY 
    ISSUER_TYPE,
    FAIR_VALUE_LEVEL;","13","Success"
"Find funds with high liquidation preference relative to their size - might affect wind-down scenarios.","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS,
    LIQUIDATION_PREFERENCE,
    (CAST(LIQUIDATION_PREFERENCE AS FLOAT) / 
     NULLIF(CAST(TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO
WHERE 
    CAST(LIQUIDATION_PREFERENCE AS FLOAT) > 1000000
ORDER BY 
    (CAST(LIQUIDATION_PREFERENCE AS FLOAT) / 
     NULLIF(CAST(TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC;","69","Success"
"How many funds does each registrant have?","SELECT 
    REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;","1063","Success"
"What are the total assets of BlackRock funds?","SELECT 
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';","1","Success"
"List all funds with their registrant names","SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;","4223","Success"
"What's the latest filing date for each fund?","SELECT 
    F.SERIES_NAME,
    MAX(S.FILING_DATE)
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME;","4005","Success"
"Show me the earliest filing date for each registrant","SELECT 
    R.REGISTRANT_NAME,
    MIN(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;","1063","Success"
"List all registrants with their fund count and total assets","SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME),
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;","1063","Success"
"Show me all Fidelity funds","SELECT 
    F.SERIES_NAME,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%FIDELITY%';","191","Success"
"List all registrants with their latest fund's assets","SELECT 
    R.REGISTRANT_NAME,
    F.TOTAL_ASSETS
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;","4223","Success"
"List all funds with their submission dates","SELECT 
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER;","4223","Success"
"Show me the registrants with the most recent filings","SELECT 
    R.REGISTRANT_NAME,
    MAX(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    MAX(S.FILING_DATE) DESC
LIMIT 1;","1","Success"
"Find out which investment firms manage the most diverse portfolio of fund types?","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;","1","Success"
"I need to check which funds may be too concentrated - find ones where a single holding is more than 10% of their portfolio?","SELECT 
    F.SERIES_NAME,
    H.ISSUER_NAME,
    H.PERCENTAGE
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    CAST(H.PERCENTAGE AS FLOAT) > 10.0;","35","Success"
"Compare how our bond funds performed against equity funds in the last month","SELECT 
    CASE 
        WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'Bond'
        WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'Equity'
    END AS Fund_Type,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)),
    COUNT(*)
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%EQUITY%'
GROUP BY 
    Fund_Type;","2","Success"
"Check which investment firms have the most diverse geographic exposure in their holdings","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT H.INVESTMENT_COUNTRY),
    COUNT(DISTINCT H.HOLDING_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.INVESTMENT_COUNTRY IS NOT NULL
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) DESC
LIMIT 1;","1","Success"
"Find which investment styles are performing best this quarter? Like growth vs value funds?","SELECT 
    CASE 
        WHEN F.SERIES_NAME LIKE '%GROWTH%' THEN 'Growth'
        WHEN F.SERIES_NAME LIKE '%VALUE%' THEN 'Value'
        WHEN F.SERIES_NAME LIKE '%BLEND%' THEN 'Blend'
        ELSE 'Other'
    END AS Investment_Style,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)),
    COUNT(*)
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
GROUP BY 
    Investment_Style
HAVING 
    Investment_Style != 'Other'
ORDER BY 
    Avg_Monthly_Return DESC;","0","Failed: no such column: Avg_Monthly_Return"
"Find me funds that might be too exposed to interest rate changes - check their duration risk","SELECT 
    SERIES_NAME,
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT),
    CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 1.0
    OR CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 1.0
ORDER BY 
    Ten_Year_Risk DESC;","0","Failed: no such column: Ten_Year_Risk"
"I need to find funds with strong and consistent returns over all three months","SELECT 
    F.SERIES_NAME,
    M.MONTHLY_TOTAL_RETURN1,
    M.MONTHLY_TOTAL_RETURN2,
    M.MONTHLY_TOTAL_RETURN3,
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT) > 0
ORDER BY 
    Avg_Return DESC;","0","Failed: no such column: Avg_Return"
"Which funds have the most foreign currency exposure? Interested in emerging markets","SELECT 
    F.SERIES_NAME,
    COUNT(DISTINCT H.CURRENCY_CODE),
    SUM(CASE 
        WHEN H.CURRENCY_CODE NOT IN ('USD', 'EUR', 'GBP', 'JPY', 'CHF') 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) 
        ELSE 0 
    END)
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY 
    Emerging_Market_Exposure DESC
LIMIT 1;","0","Failed: no such column: Emerging_Market_Exposure"
"Show me which asset categories had the best returns last month?","SELECT 
    H.ASSET_CAT,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F 
        ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    H.ASSET_CAT
ORDER BY 
    Avg_Return DESC
LIMIT 1;","0","Failed: no such column: Avg_Return"
"Which registrants have the most diverse mix of fund types in their lineup?","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%BALANCED%' THEN 'BALANCED'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count,
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;","0","Failed: near ""FROM"": syntax error"
"How have the largest funds performed compared to smaller ones this quarter?","SELECT 
    NTILE(4) OVER (ORDER BY CAST(F.TOTAL_ASSETS AS FLOAT)),
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)),
    COUNT(*),
    AVG(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    F.TOTAL_ASSETS IS NOT NULL
    AND M.MONTHLY_TOTAL_RETURN1 IS NOT NULL
GROUP BY 
    Size_Quartile
ORDER BY 
    Size_Quartile;","0","Failed: no such column: Size_Quartile"
"Which investment companies are most exposed to international markets?","SELECT 
    R.REGISTRANT_NAME,
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END),
    COUNT(*),
    SUM(CASE WHEN H.INVESTMENT_COUNTRY != 'US' 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) ELSE 0 END)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    Total_Holdings > 10
ORDER BY 
    International_Holdings DESC
LIMIT 1;","0","Failed: no such column: Total_Holdings"
"Help me find funds that might be too concentrated in specific sectors","SELECT 
    F.SERIES_NAME,
    H.ASSET_CAT,
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    F.SERIES_NAME, H.ASSET_CAT, F.TOTAL_ASSETS
ORDER BY 
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100 DESC;","4867","Success"
"Which funds are taking on the most interest rate risk?","SELECT 
    F.SERIES_NAME,
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) DESC
LIMIT 1;","1","Success"
"Identify funds with highest portfolio turnover based on their trading activity?","SELECT 
    F.SERIES_NAME,
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SALES_FLOW_MON1 IS NOT NULL 
    AND F.SALES_FLOW_MON2 IS NOT NULL 
    AND F.SALES_FLOW_MON3 IS NOT NULL
GROUP BY 
    F.SERIES_NAME, F.TOTAL_ASSETS
HAVING 
    F.TOTAL_ASSETS > 0
ORDER BY 
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC
LIMIT 1;","1","Success"
"See which fund families are most active in securities lending","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END),
    COUNT(DISTINCT F.SERIES_NAME),
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    LEFT JOIN SECURITIES_LENDING SL 
        ON F.ACCESSION_NUMBER = SL.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME)) DESC
LIMIT 1;","1","Success"
"Check for funds with significant counterparty exposure through their derivatives","SELECT 
    F.SERIES_NAME,
    DC.DERIVATIVE_COUNTERPARTY_NAME,
    COUNT(*),
    COUNT(DISTINCT DC.HOLDING_ID)
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN DERIVATIVE_COUNTERPARTY DC 
        ON H.HOLDING_ID = DC.HOLDING_ID
GROUP BY 
    F.SERIES_NAME, DC.DERIVATIVE_COUNTERPARTY_NAME
ORDER BY 
    Transaction_Count DESC;","0","Failed: no such column: Transaction_Count"
"Find funds with unusual monthly return patterns - looking for potential outliers","SELECT 
    F.SERIES_NAME,
    CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT),
    CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT),
    CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT),
    ABS(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) - 
        (CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 2)
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    M.MONTHLY_TOTAL_RETURN1 IS NOT NULL
    AND M.MONTHLY_TOTAL_RETURN2 IS NOT NULL
    AND M.MONTHLY_TOTAL_RETURN3 IS NOT NULL
ORDER BY 
    Return_Deviation DESC

29. ""Show me which funds have the most diverse debt security holdings by maturity""
SELECT 
    F.SERIES_NAME,
    COUNT(DISTINCT CASE 
        WHEN DS.MATURITY_DATE <= DATE('now', '+1 year') THEN 'SHORT_TERM'
        WHEN DS.MATURITY_DATE <= DATE('now', '+5 year') THEN 'MEDIUM_TERM'
        ELSE 'LONG_TERM'
    END) AS Maturity_Types
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN DEBT_SECURITY DS 
        ON H.HOLDING_ID = DS.HOLDING_ID
WHERE 
    DS.MATURITY_DATE IS NOT NULL
GROUP BY 
    F.SERIES_NAME
ORDER BY 
    Maturity_Types DESC
LIMIT 1;","0","Failed: near ""29."": syntax error"
"Show me quarterly changes in securities lending activity","SELECT 
    QUARTER,
    COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN SERIES_NAME END),
    COUNT(DISTINCT SERIES_NAME),
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN SERIES_NAME END) * 100.0 / COUNT(DISTINCT SERIES_NAME))
FROM 
    FUND_REPORTED_INFO F
    LEFT JOIN SECURITIES_LENDING SL 
        ON F.ACCESSION_NUMBER = SL.HOLDING_ID
GROUP BY 
    QUARTER
ORDER BY 
    QUARTER DESC;","0","Failed: ambiguous column name: QUARTER"
"How has the geographic distribution of investments changed quarterly?","SELECT 
    QUARTER,
    INVESTMENT_COUNTRY,
    COUNT(*) AS Number_of_Holdings,
    SUM(CAST(CURRENCY_VALUE AS FLOAT)),
    COUNT(DISTINCT SERIES_NAME)
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F 
        ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    INVESTMENT_COUNTRY IS NOT NULL
GROUP BY 
    QUARTER, INVESTMENT_COUNTRY
ORDER BY 
    QUARTER DESC, Total_Investment_Value DESC;","0","Failed: ambiguous column name: QUARTER"
"How many funds does each investment company manage?","SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT SERIES_NAME),
    COUNT(DISTINCT SERIES_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;","1063","Success"
"Which USD funds are most exposed to interest rate changes?","SELECT 
    F.SERIES_NAME,
    IR.INTRST_RATE_CHANGE_10YR_DV01,
    IR.INTRST_RATE_CHANGE_30YR_DV01,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    IR.CURRENCY_CODE = 'USD'
    AND (
        CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 100000
        OR CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 100000
    )
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) DESC
LIMIT 1;","1","Success"
"What's our exposure by state? Need to check geographic concentration.","SELECT 
    R.STATE,
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.STATE IS NOT NULL
GROUP BY 
    R.STATE;","41","Success"
"Which securities are most actively lent out?","SELECT 
    H.ISSUER_NAME,
    COUNT(*),
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING H
    JOIN SECURITIES_LENDING SL ON H.HOLDING_ID = SL.HOLDING_ID
WHERE 
    SL.IS_LOAN_BY_FUND = 'Y'
GROUP BY 
    H.ISSUER_NAME
HAVING 
    COUNT(*) > 1
ORDER BY 
    COUNT(*) DESC,
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) DESC
LIMIT 1;","1","Success"
"What's the geographic distribution of our international holdings?","SELECT 
    H.INVESTMENT_COUNTRY,
    COUNT(DISTINCT F.SERIES_NAME),
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT)),
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) / 
    SUM(SUM(CAST(H.CURRENCY_VALUE AS FLOAT))) OVER () * 100
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    H.INVESTMENT_COUNTRY IS NOT NULL
    AND H.INVESTMENT_COUNTRY != 'US'
GROUP BY 
    H.INVESTMENT_COUNTRY;","45","Success"
"Analyze bond maturity distribution across credit ratings","SELECT 
    H.FAIR_VALUE_LEVEL AS Credit_Rating,
    COUNT(CASE WHEN D.MATURITY_DATE <= DATE('now', '+1 year') THEN 1 END) AS Short_Term,
    COUNT(CASE WHEN D.MATURITY_DATE > DATE('now', '+1 year') AND D.MATURITY_DATE <= DATE('now', '+5 year') THEN 1 END) AS Medium_Term,
    COUNT(CASE WHEN D.MATURITY_DATE > DATE('now', '+5 year') THEN 1 END) AS Long_Term
FROM 
    FUND_REPORTED_HOLDING H
    JOIN DEBT_SECURITY D 
        ON H.HOLDING_ID = D.HOLDING_ID
WHERE 
    D.MATURITY_DATE IS NOT NULL
GROUP BY 
    H.QUARTER,
    H.FAIR_VALUE_LEVEL;","3","Success"
"Let's look at convertible securities with high conversion ratios - could be significant upside.","SELECT 
    F.SERIES_NAME,
    H.ISSUER_NAME,
    CSC.CONVERSION_RATIO,
    H.CURRENCY_VALUE
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN CONVERTIBLE_SECURITY_CURRENCY CSC ON H.HOLDING_ID = CSC.HOLDING_ID
WHERE 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) > 1
ORDER BY 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) DESC;","0","Success"
"What percentage of bonds have missed interest payments by sector?","SELECT
    h.ISSUER_TYPE,
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*))
FROM 
    FUND_REPORTED_HOLDING h
    JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
WHERE 
    h.ISSUER_TYPE IS NOT NULL
GROUP BY 
    h.ISSUER_TYPE
ORDER BY 
    h.QUARTER DESC,
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*)) DESC;","7","Success"
"Group funds into size categories based on their net assets","WITH FundSizeBuckets AS (
    SELECT 
        SERIES_NAME,
        CAST(NET_ASSETS AS FLOAT) AS Net_Assets,
        CASE 
            WHEN CAST(NET_ASSETS AS FLOAT) >= 10000000000 THEN 'Very Large (>10B)'
            WHEN CAST(NET_ASSETS AS FLOAT) >= 1000000000 THEN 'Large (1B-10B)'
            WHEN CAST(NET_ASSETS AS FLOAT) >= 100000000 THEN 'Medium (100M-1B)'
            ELSE 'Small (<100M)'
        END AS Size_Category
    FROM 
        FUND_REPORTED_INFO
    WHERE 
        NET_ASSETS IS NOT NULL
)
SELECT 
    Size_Category,
    COUNT(*),
    AVG(Net_Assets),
    MIN(Net_Assets),
    MAX(Net_Assets)
FROM 
    FundSizeBuckets
GROUP BY 
    Size_Category;","4","Success"
"Which investment firms seem to be growing the fastest based on their asset growth?","WITH AssetGrowth AS (
    SELECT 
        R.REGISTRANT_NAME,
        SUM(CAST(F.TOTAL_ASSETS AS FLOAT)) as Current_Assets,
        LAG(SUM(CAST(F.TOTAL_ASSETS AS FLOAT))) OVER (
            PARTITION BY R.REGISTRANT_NAME 
            ORDER BY S.FILING_DATE
        ) as Previous_Assets,
        S.FILING_DATE
    FROM 
        REGISTRANT R
        JOIN FUND_REPORTED_INFO F 
            ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
        JOIN SUBMISSION S 
            ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
    GROUP BY 
        R.REGISTRANT_NAME,
        S.FILING_DATE
)
SELECT 
    REGISTRANT_NAME,
    ((Current_Assets - Previous_Assets) / Previous_Assets * 100)
FROM 
    AssetGrowth
WHERE 
    Previous_Assets IS NOT NULL
    AND Previous_Assets > 0
ORDER BY 
    Growth_Percentage DESC
LIMIT 1;","0","Failed: no such column: Growth_Percentage"
"Any funds that seem to be taking on more risk lately? Look at their borrowing trends.","WITH BorrowingTrends AS (
    SELECT 
        F.SERIES_NAME,
        F.TOTAL_ASSETS,
        F.BORROWING_PAY_WITHIN_1YR,
        F.BORROWING_PAY_AFTER_1YR,
        CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100 as Short_Term_Borrow_Ratio,
        CAST(F.BORROWING_PAY_AFTER_1YR AS FLOAT) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100 as Long_Term_Borrow_Ratio
    FROM 
        FUND_REPORTED_INFO F
)
SELECT 
    SERIES_NAME,
    Short_Term_Borrow_Ratio,
    Long_Term_Borrow_Ratio,
    Short_Term_Borrow_Ratio + Long_Term_Borrow_Ratio
FROM 
    BorrowingTrends
WHERE 
    Short_Term_Borrow_Ratio + Long_Term_Borrow_Ratio > 10;","119","Success"
"What are the top 5 largest funds by total assets for each quarter?","WITH RankedFunds AS (
    SELECT 
        QUARTER,
        SERIES_NAME,
        CAST(TOTAL_ASSETS AS FLOAT) as Assets,
        ROW_NUMBER() OVER (PARTITION BY QUARTER ORDER BY CAST(TOTAL_ASSETS AS FLOAT) DESC) as Rank
    FROM 
        FUND_REPORTED_INFO
    WHERE 
        TOTAL_ASSETS IS NOT NULL
)
SELECT 
    QUARTER,
    SERIES_NAME,
    Assets
FROM 
    RankedFunds
WHERE 
    Rank <= 5
ORDER BY 
    QUARTER DESC, 
    Assets DESC;","5","Success"
"I need to check for concentration risk - show me any holdings that are the biggest position in their funds.","WITH HoldingPercentages AS (
    SELECT 
        F.SERIES_NAME,
        H.ISSUER_NAME,
        H.PERCENTAGE,
        ROW_NUMBER() OVER (PARTITION BY F.SERIES_NAME ORDER BY CAST(H.PERCENTAGE AS FLOAT) DESC) as Position_Rank
    FROM 
        FUND_REPORTED_INFO F
        JOIN FUND_REPORTED_HOLDING H 
            ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    WHERE 
        H.PERCENTAGE IS NOT NULL
)
SELECT 
    SERIES_NAME,
    ISSUER_NAME,
    PERCENTAGE
FROM 
    HoldingPercentages
WHERE 
    Position_Rank = 1
ORDER BY 
    CAST(PERCENTAGE AS FLOAT) DESC;","4005","Success"
"Check for funds with large outstanding commitments, delayed delivery and standby.","WITH CommitmentExposure AS (
    SELECT 
        SERIES_NAME,
        DELAYED_DELIVERY,
        STANDBY_COMMITMENT,
        TOTAL_ASSETS,
        (CAST(DELAYED_DELIVERY AS FLOAT) + CAST(STANDBY_COMMITMENT AS FLOAT)) / 
        NULLIF(CAST(TOTAL_ASSETS AS FLOAT), 0) * 100 as Total_Commitment_Percentage
    FROM 
        FUND_REPORTED_INFO
    WHERE 
        DELAYED_DELIVERY IS NOT NULL 
        AND STANDBY_COMMITMENT IS NOT NULL
)
SELECT 
    SERIES_NAME,
    DELAYED_DELIVERY,
    STANDBY_COMMITMENT,
    Total_Commitment_Percentage
FROM 
    CommitmentExposure
WHERE 
    Total_Commitment_Percentage > 5
ORDER BY 
    Total_Commitment_Percentage DESC;","169","Success"
"Find any funds where assets dropped despite positive sales.","WITH FundFlows AS (
    SELECT 
        F.SERIES_NAME,
        F.NET_ASSETS,
        LAG(F.NET_ASSETS) OVER (PARTITION BY F.SERIES_ID ORDER BY F.QUARTER) as Prev_Assets,
        (F.SALES_FLOW_MON1 + F.SALES_FLOW_MON2 + F.SALES_FLOW_MON3) as Total_Sales
    FROM 
        FUND_REPORTED_INFO F
)
SELECT 
    SERIES_NAME,
    NET_ASSETS,
    Prev_Assets,
    Total_Sales,
    ((CAST(NET_ASSETS AS FLOAT) - CAST(Prev_Assets AS FLOAT)) / 
     NULLIF(CAST(Prev_Assets AS FLOAT), 0)) * 100 as Asset_Change_Pct
FROM 
    FundFlows
WHERE 
    CAST(NET_ASSETS AS FLOAT) < CAST(Prev_Assets AS FLOAT)
    AND CAST(Total_Sales AS FLOAT) > 0
ORDER BY 
    Asset_Change_Pct;","84","Success"
"What's the average yield on our defaulted bonds? Need to see recovery potential.","WITH DefaultedSecurities AS (
    SELECT 
        F.SERIES_NAME,
        DS.ANNUALIZED_RATE,
        H.CURRENCY_VALUE,
        H.ISSUER_NAME
    FROM 
        DEBT_SECURITY DS
        JOIN FUND_REPORTED_HOLDING H ON DS.HOLDING_ID = H.HOLDING_ID
        JOIN FUND_REPORTED_INFO F ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE 
        DS.IS_DEFAULT = 'Y'
)
SELECT 
    SERIES_NAME,
    ISSUER_NAME,
    ANNUALIZED_RATE,
    CURRENCY_VALUE
FROM 
    DefaultedSecurities
ORDER BY 
    CAST(ANNUALIZED_RATE AS FLOAT) DESC;","45","Success"
"Give me our largest derivative counterparty exposures - need to check concentration risk.","WITH CounterpartyExposure AS (
    SELECT 
        DC.DERIVATIVE_COUNTERPARTY_NAME,
        COUNT(DISTINCT F.SERIES_NAME) as Fund_Count,
        SUM(CAST(NFES.NOTIONAL_AMOUNT AS FLOAT)) as Total_Exposure
    FROM 
        DERIVATIVE_COUNTERPARTY DC
        JOIN NONFOREIGN_EXCHANGE_SWAP NFES ON DC.HOLDING_ID = NFES.HOLDING_ID
        JOIN FUND_REPORTED_HOLDING H ON DC.HOLDING_ID = H.HOLDING_ID
        JOIN FUND_REPORTED_INFO F ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY 
        DC.DERIVATIVE_COUNTERPARTY_NAME
)
SELECT 
    DERIVATIVE_COUNTERPARTY_NAME,
    Fund_Count,
    Total_Exposure,
    Total_Exposure / SUM(Total_Exposure) OVER () * 100 as Exposure_Percentage
FROM 
    CounterpartyExposure
ORDER BY 
    Total_Exposure DESC
LIMIT 1;","1","Success"
"Show me funds facing redemption pressure - where outflows exceed inflows consistently.","WITH FlowAnalysis AS (
    SELECT 
        SERIES_NAME,
        (CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + 
         CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + 
         CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) as Total_Redemptions,
        (CAST(SALES_FLOW_MON1 AS FLOAT) + 
         CAST(SALES_FLOW_MON2 AS FLOAT) + 
         CAST(SALES_FLOW_MON3 AS FLOAT)) as Total_Sales
    FROM 
        FUND_REPORTED_INFO
)
SELECT 
    SERIES_NAME,
    Total_Redemptions,
    Total_Sales,
    (Total_Redemptions - Total_Sales)
FROM 
    FlowAnalysis
WHERE 
    Total_Redemptions > Total_Sales
ORDER BY 
    (Total_Redemptions - Total_Sales) DESC;","2379","Success"
"How do PIMCO's bond funds compare to their equity funds in terms of growth?","WITH PIMCOPerformance AS (
    SELECT 
        F.SERIES_NAME,
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'Bond'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'Equity'
            ELSE 'Other'
        END as Fund_Type,
        M.MONTHLY_TOTAL_RETURN1,
        F.TOTAL_ASSETS
    FROM 
        FUND_REPORTED_INFO F
        JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
        JOIN MONTHLY_TOTAL_RETURN M ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
    WHERE 
        R.REGISTRANT_NAME LIKE '%PIMCO%'
)
SELECT 
    Fund_Type,
    COUNT(*) as Fund_Count,
    AVG(CAST(MONTHLY_TOTAL_RETURN1 AS FLOAT)) as Avg_Monthly_Return,
    SUM(CAST(TOTAL_ASSETS AS FLOAT)) as Total_AUM
FROM 
    PIMCOPerformance
WHERE 
    Fund_Type IN ('Bond', 'Equity')
GROUP BY 
    Fund_Type;","2","Success"
"Which asset categories are driving our best returns this quarter?","WITH CategoryPerformance AS (
    SELECT 
        H.ASSET_CAT,
        AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)) as Avg_Return,
        SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) as Total_Value,
        COUNT(DISTINCT F.SERIES_NAME) as Fund_Count
    FROM 
        FUND_REPORTED_HOLDING H
        JOIN FUND_REPORTED_INFO F ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
        JOIN MONTHLY_TOTAL_RETURN M ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
    WHERE 
        H.ASSET_CAT IS NOT NULL
    GROUP BY 
        H.ASSET_CAT
)
SELECT 
    ASSET_CAT,
    Avg_Return,
    Total_Value,
    Fund_Count
FROM 
    CategoryPerformance
ORDER BY 
    Avg_Return DESC
LIMIT 1;","1","Success"
"Where are we seeing the biggest month-over-month changes in fund flows?","WITH FlowTrends AS (
    SELECT 
        F.SERIES_NAME,
        F.SALES_FLOW_MON1,
        F.SALES_FLOW_MON2,
        ((CAST(F.SALES_FLOW_MON1 AS FLOAT) - CAST(F.SALES_FLOW_MON2 AS FLOAT)) / 
         NULLIF(CAST(F.SALES_FLOW_MON2 AS FLOAT), 0)) * 100 as Flow_Change_Pct
    FROM 
        FUND_REPORTED_INFO F
    WHERE 
        F.SALES_FLOW_MON1 IS NOT NULL 
        AND F.SALES_FLOW_MON2 IS NOT NULL
)
SELECT 
    SERIES_NAME,
    SALES_FLOW_MON1 as Current_Flow,
    SALES_FLOW_MON2 as Previous_Flow,
    Flow_Change_Pct
FROM 
    FlowTrends
WHERE 
    ABS(Flow_Change_Pct) > 10
ORDER BY 
    ABS(Flow_Change_Pct) DESC
LIMIT 1;","1","Success"
"What's PIMCO's current duration positioning across their major bond funds?","WITH PIMCODuration AS (
    SELECT 
        F.SERIES_NAME,
        IR.INTRST_RATE_CHANGE_10YR_DV01,
        IR.INTRST_RATE_CHANGE_30YR_DV01,
        F.TOTAL_ASSETS
    FROM 
        FUND_REPORTED_INFO F
        JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
        JOIN INTEREST_RATE_RISK IR ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
    WHERE 
        R.REGISTRANT_NAME LIKE '%PIMCO%'
        AND F.SERIES_NAME LIKE '%BOND%'
)
SELECT 
    SERIES_NAME,
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) as Ten_Year_Duration,
    CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) as Thirty_Year_Duration,
    TOTAL_ASSETS
FROM 
    PIMCODuration;","227","Success"
"How are our largest funds positioned in terms of credit quality?","WITH CreditQuality AS (
    SELECT 
        F.SERIES_NAME,
        F.CREDIT_SPREAD_10YR_INVEST,
        F.CREDIT_SPREAD_10YR_NONINVEST,
        F.TOTAL_ASSETS,
        CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) / 
        NULLIF(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) + 
               CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT), 0) * 100 as IG_Percentage
    FROM 
        FUND_REPORTED_INFO F
    WHERE 
        CAST(F.TOTAL_ASSETS AS FLOAT) > 1000000000
)
SELECT 
    SERIES_NAME,
    IG_Percentage,
    TOTAL_ASSETS
FROM 
    CreditQuality
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me our best performing strategies in rising rate environments.","WITH RatePerformance AS (
    SELECT 
        F.SERIES_NAME,
        M.MONTHLY_TOTAL_RETURN1,
        IR.INTRST_RATE_CHANGE_10YR_DV01
    FROM 
        FUND_REPORTED_INFO F
        JOIN MONTHLY_TOTAL_RETURN M ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
        JOIN INTEREST_RATE_RISK IR ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
    WHERE 
        CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 0
)
SELECT 
    SERIES_NAME,
    AVG(CAST(MONTHLY_TOTAL_RETURN1 AS FLOAT)) as Avg_Return,
    AVG(CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT)) as Avg_Rate_Sensitivity
FROM 
    RatePerformance
GROUP BY 
    SERIES_NAME
ORDER BY 
    Avg_Return DESC
LIMIT 1;","1","Success"
"How diverse are our income sources across the portfolio?","WITH IncomeAnalysis AS (
    SELECT 
        F.SERIES_NAME,
        SUM(CASE 
            WHEN DS.COUPON_TYPE = 'Fixed' THEN CAST(H.CURRENCY_VALUE AS FLOAT) 
            ELSE 0 
        END) as Fixed_Income,
        SUM(CASE 
            WHEN DS.COUPON_TYPE = 'Floating' THEN CAST(H.CURRENCY_VALUE AS FLOAT) 
            ELSE 0 
        END) as Floating_Income,
        SUM(CASE 
            WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN CAST(H.CURRENCY_VALUE AS FLOAT) 
            ELSE 0 
        END) as Securities_Lending_Income,
        CAST(F.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO F
        JOIN FUND_REPORTED_HOLDING H 
            ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
        LEFT JOIN DEBT_SECURITY DS 
            ON H.HOLDING_ID = DS.HOLDING_ID
        LEFT JOIN SECURITIES_LENDING SL 
            ON H.HOLDING_ID = SL.HOLDING_ID
    GROUP BY 
        F.SERIES_NAME,
        F.TOTAL_ASSETS
)
SELECT 
    SERIES_NAME,
    (Fixed_Income / Total_Assets * 100) as Fixed_Income_Pct,
    (Floating_Income / Total_Assets * 100) as Floating_Income_Pct,
    (Securities_Lending_Income / Total_Assets * 100) as Sec_Lending_Pct,
    ((Fixed_Income + Floating_Income + Securities_Lending_Income) / Total_Assets * 100),
    Total_Assets
FROM 
    IncomeAnalysis
WHERE 
    Total_Assets > 0;","4220","Success"
"Give me a complete risk profile of PIMCO's largest funds - looking at duration, credit, and leverage exposure","WITH PIMCORiskProfile AS (
    SELECT 
        F.SERIES_NAME,
        F.TOTAL_ASSETS,
        -- Duration Risk
        IR.INTRST_RATE_CHANGE_10YR_DV01 as Duration_Risk,
        -- Credit Risk
        (CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT) / 
         NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100 as High_Yield_Exposure,
        -- Leverage
        (CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT) + 
         CAST(F.BORROWING_PAY_AFTER_1YR AS FLOAT)) / 
         NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100 as Leverage_Ratio,
        -- Derivatives Exposure
        COUNT(DISTINCT OD.HOLDING_ID) as Derivative_Positions,
        -- Liquidity Profile
        CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / 
        NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100 as Cash_Position,
        -- Recent Performance
        M.MONTHLY_TOTAL_RETURN1
    FROM 
        FUND_REPORTED_INFO F
        JOIN REGISTRANT R 
            ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
        LEFT JOIN INTEREST_RATE_RISK IR 
            ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
        LEFT JOIN OTHER_DERIV OD 
            ON F.ACCESSION_NUMBER = OD.HOLDING_ID
        LEFT JOIN MONTHLY_TOTAL_RETURN M 
            ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
    WHERE 
        R.REGISTRANT_NAME LIKE '%PIMCO%'
        AND F.TOTAL_ASSETS IS NOT NULL
    GROUP BY 
        F.SERIES_NAME,
        F.TOTAL_ASSETS,
        IR.INTRST_RATE_CHANGE_10YR_DV01,
        F.CREDIT_SPREAD_10YR_NONINVEST,
        F.BORROWING_PAY_WITHIN_1YR,
        F.BORROWING_PAY_AFTER_1YR,
        F.CASH_NOT_RPTD_IN_C_OR_D,
        M.MONTHLY_TOTAL_RETURN1
)
SELECT 
    SERIES_NAME,
    CAST(TOTAL_ASSETS AS FLOAT) / 1000000 as Assets_MM,
    Duration_Risk as Duration_DV01,
    High_Yield_Exposure as HY_Pct,
    Leverage_Ratio as Leverage_Pct,
    Derivative_Positions,
    Cash_Position as Cash_Pct,
    CAST(MONTHLY_TOTAL_RETURN1 AS FLOAT) as Latest_Monthly_Return,
    CASE
        WHEN Duration_Risk > 1 AND High_Yield_Exposure > 20 THEN 'High Risk'
        WHEN Duration_Risk > 1 OR High_Yield_Exposure > 20 THEN 'Moderate Risk'
        ELSE 'Conservative'
    END as Risk_Category
FROM 
    PIMCORiskProfile
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"How does PIMCO's credit quality distribution compare to industry averages by quarter?","WITH CreditMetrics AS (
    SELECT 
        f.QUARTER,
        r.REGISTRANT_NAME,
        f.SERIES_NAME,
        CAST(f.CREDIT_SPREAD_10YR_INVEST AS FLOAT) as Investment_Grade,
        CAST(f.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT) as Non_Investment_Grade,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO f
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
    WHERE 
        f.CREDIT_SPREAD_10YR_INVEST IS NOT NULL 
        OR f.CREDIT_SPREAD_10YR_NONINVEST IS NOT NULL
),
PIMCOStats AS (
    SELECT 
        QUARTER,
        AVG(Investment_Grade) as PIMCO_Inv_Grade,
        AVG(Non_Investment_Grade) as PIMCO_Non_Inv_Grade,
        SUM(Total_Assets) as PIMCO_Total_Assets
    FROM 
        CreditMetrics
    WHERE 
        REGISTRANT_NAME LIKE '%PIMCO%'
    GROUP BY 
        QUARTER
),
IndustryStats AS (
    SELECT 
        QUARTER,
        AVG(Investment_Grade) as Industry_Inv_Grade,
        AVG(Non_Investment_Grade) as Industry_Non_Inv_Grade,
        SUM(Total_Assets) as Industry_Total_Assets
    FROM 
        CreditMetrics
    GROUP BY 
        QUARTER
)
SELECT 
    p.QUARTER,
    p.PIMCO_Inv_Grade,
    i.Industry_Inv_Grade,
    p.PIMCO_Non_Inv_Grade,
    i.Industry_Non_Inv_Grade,
    p.PIMCO_Total_Assets / i.Industry_Total_Assets * 100
FROM 
    PIMCOStats p
    JOIN IndustryStats i ON p.QUARTER = i.QUARTER
ORDER BY 
    p.QUARTER DESC;","1","Success"
"Track PIMCO's international exposure trends across quarters","WITH InternationalHoldings AS (
    SELECT 
        h.QUARTER,
        r.REGISTRANT_NAME,
        h.INVESTMENT_COUNTRY,
        COUNT(*) as Holdings_Count,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Total_Value
    FROM 
        FUND_REPORTED_HOLDING h
        JOIN FUND_REPORTED_INFO f ON h.ACCESSION_NUMBER = f.ACCESSION_NUMBER
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
    WHERE 
        r.REGISTRANT_NAME LIKE '%PIMCO%'
        AND h.INVESTMENT_COUNTRY IS NOT NULL
    GROUP BY 
        h.QUARTER,
        r.REGISTRANT_NAME,
        h.INVESTMENT_COUNTRY
),
QuarterlyTotals AS (
    SELECT 
        QUARTER,
        SUM(Total_Value) as Quarter_Total_Value
    FROM 
        InternationalHoldings
    GROUP BY 
        QUARTER
)
SELECT 
    i.QUARTER,
    i.INVESTMENT_COUNTRY,
    i.Holdings_Count,
    i.Total_Value,
    i.Total_Value / qt.Quarter_Total_Value * 100
FROM 
    InternationalHoldings i
    JOIN QuarterlyTotals qt ON i.QUARTER = qt.QUARTER
WHERE 
    i.INVESTMENT_COUNTRY != 'US'
ORDER BY 
    i.QUARTER DESC;","26","Success"
"Compare PIMCO's fixed income duration positioning vs competitors","WITH DurationMetrics AS (
    SELECT 
        f.QUARTER,
        r.REGISTRANT_NAME,
        ir.INTRST_RATE_CHANGE_10YR_DV01 as Duration_10Y,
        ir.INTRST_RATE_CHANGE_30YR_DV01 as Duration_30Y,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO f
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
        JOIN INTEREST_RATE_RISK ir ON f.ACCESSION_NUMBER = ir.ACCESSION_NUMBER
    WHERE 
        f.SERIES_NAME LIKE '%BOND%'
        OR f.SERIES_NAME LIKE '%FIXED%'
        OR f.SERIES_NAME LIKE '%INCOME%'
),
CompanyDuration AS (
    SELECT 
        QUARTER,
        REGISTRANT_NAME,
        AVG(CAST(Duration_10Y AS FLOAT)) as Avg_Duration_10Y,
        AVG(CAST(Duration_30Y AS FLOAT)) as Avg_Duration_30Y,
        SUM(Total_Assets) as Company_Assets
    FROM 
        DurationMetrics
    GROUP BY 
        QUARTER,
        REGISTRANT_NAME
)
SELECT 
    p.QUARTER,
    p.Avg_Duration_10Y as PIMCO_Duration_10Y,
    p.Avg_Duration_30Y as PIMCO_Duration_30Y,
    i.Avg_Duration_10Y as Industry_Avg_Duration_10Y,
    i.Avg_Duration_30Y as Industry_Avg_Duration_30Y
FROM 
    CompanyDuration p
    CROSS JOIN (
        SELECT 
            QUARTER,
            AVG(Avg_Duration_10Y) as Avg_Duration_10Y,
            AVG(Avg_Duration_30Y) as Avg_Duration_30Y
        FROM 
            CompanyDuration
        WHERE 
            REGISTRANT_NAME NOT LIKE '%PIMCO%'
        GROUP BY 
            QUARTER
    ) i
WHERE 
    p.QUARTER = i.QUARTER
    AND p.REGISTRANT_NAME LIKE '%PIMCO%'
ORDER BY 
    p.QUARTER DESC;","5","Success"
"Analyze PIMCO's cash management strategy vs peers","WITH CashPositions AS (
    SELECT 
        f.QUARTER,
        r.REGISTRANT_NAME,
        f.SERIES_NAME,
        CAST(f.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) as Cash_Position,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO f
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
    WHERE 
        f.CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
),
CompanyCashMetrics AS (
    SELECT 
        QUARTER,
        REGISTRANT_NAME,
        AVG(Cash_Position / NULLIF(Total_Assets, 0) * 100) as Avg_Cash_Percentage,
        COUNT(DISTINCT SERIES_NAME) as Number_of_Funds
    FROM 
        CashPositions
    GROUP BY 
        QUARTER,
        REGISTRANT_NAME
    HAVING 
        Number_of_Funds >= 5
)
SELECT 
    p.QUARTER,
    p.Avg_Cash_Percentage as PIMCO_Cash_Percentage,
    i.Industry_Cash_Percentage,
    p.Number_of_Funds as PIMCO_Funds,
    p.Avg_Cash_Percentage - i.Industry_Cash_Percentage as Cash_Differential
FROM 
    CompanyCashMetrics p
    CROSS JOIN (
        SELECT 
            QUARTER,
            AVG(Avg_Cash_Percentage) as Industry_Cash_Percentage
        FROM 
            CompanyCashMetrics
        WHERE 
            REGISTRANT_NAME NOT LIKE '%PIMCO%'
        GROUP BY 
            QUARTER
    ) i
WHERE 
    p.QUARTER = i.QUARTER
    AND p.REGISTRANT_NAME LIKE '%PIMCO%'
ORDER BY 
    p.QUARTER DESC;","4","Success"
"Examine PIMCO's securities lending activity and revenue","WITH LendingActivity AS (
    SELECT 
        f.QUARTER,
        r.REGISTRANT_NAME,
        f.SERIES_NAME,
        COUNT(CASE WHEN sl.IS_LOAN_BY_FUND = 'Y' THEN 1 END) as Securities_Lent,
        COUNT(*) as Total_Securities,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Fund_Assets
    FROM 
        FUND_REPORTED_INFO f
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
        LEFT JOIN SECURITIES_LENDING sl ON f.ACCESSION_NUMBER = sl.HOLDING_ID
    GROUP BY 
        f.QUARTER,
        r.REGISTRANT_NAME,
        f.SERIES_NAME,
        f.TOTAL_ASSETS
),
CompanyMetrics AS (
    SELECT 
        QUARTER,
        REGISTRANT_NAME,
        SUM(Securities_Lent) as Total_Securities_Lent,
        SUM(Total_Securities) as Total_Securities,
        SUM(Fund_Assets) as Total_Assets,
        COUNT(DISTINCT SERIES_NAME) as Number_of_Funds
    FROM 
        LendingActivity
    GROUP BY 
        QUARTER,
        REGISTRANT_NAME
)
SELECT 
    p.QUARTER,
    p.Total_Securities_Lent as PIMCO_Securities_Lent,
    p.Total_Securities as PIMCO_Total_Securities,
    (p.Total_Securities_Lent * 100.0 / NULLIF(p.Total_Securities, 0)) as PIMCO_Lending_Percentage,
    (i.Total_Securities_Lent * 100.0 / NULLIF(i.Total_Securities, 0)) as Industry_Lending_Percentage
FROM 
    CompanyMetrics p
    CROSS JOIN (
        SELECT 
            QUARTER,
            SUM(Total_Securities_Lent) as Total_Securities_Lent,
            SUM(Total_Securities) as Total_Securities
        FROM 
            CompanyMetrics
        WHERE 
            REGISTRANT_NAME NOT LIKE '%PIMCO%'
        GROUP BY 
            QUARTER
    ) i
WHERE 
    p.QUARTER = i.QUARTER
    AND p.REGISTRANT_NAME LIKE '%PIMCO%'
ORDER BY 
    p.QUARTER DESC;","24","Success"
"Track PIMCO's market share by asset category over time","WITH AssetCategories AS (
    SELECT 
        h.QUARTER,
        r.REGISTRANT_NAME,
        h.ASSET_CAT,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Category_Value
    FROM 
        FUND_REPORTED_HOLDING h
        JOIN FUND_REPORTED_INFO f ON h.ACCESSION_NUMBER = f.ACCESSION_NUMBER
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
    WHERE 
        h.ASSET_CAT IS NOT NULL
    GROUP BY 
        h.QUARTER,
        r.REGISTRANT_NAME,
        h.ASSET_CAT
),
MarketShares AS (
    SELECT 
        p.QUARTER,
        p.ASSET_CAT,
        p.Category_Value as PIMCO_Value,
        t.Total_Category_Value,
        (p.Category_Value * 100.0 / NULLIF(t.Total_Category_Value, 0)) as Market_Share
    FROM 
        AssetCategories p
        JOIN (
            SELECT 
                QUARTER,
                ASSET_CAT,
                SUM(Category_Value) as Total_Category_Value
            FROM 
                AssetCategories
            GROUP BY 
                QUARTER,
                ASSET_CAT
        ) t ON p.QUARTER = t.QUARTER AND p.ASSET_CAT = t.ASSET_CAT
    WHERE 
        p.REGISTRANT_NAME LIKE '%PIMCO%'
)
SELECT 
    QUARTER,
    ASSET_CAT,
    ROUND(PIMCO_Value / 1000000, 2) as PIMCO_Value_Millions,
    ROUND(Total_Category_Value / 1000000, 2) as Total_Market_Millions,
    ROUND(Market_Share, 2) as Market_Share_Percentage,
    ROW_NUMBER() OVER (PARTITION BY QUARTER ORDER BY Market_Share DESC)
FROM 
    MarketShares
ORDER BY 
    QUARTER DESC;","38","Success"
"Show me the most commonly used CUSIP numbers across all holdings","WITH CUSIPFrequency AS (
    SELECT 
        ISSUER_CUSIP,
        COUNT(*) as Usage_Count,
        COUNT(DISTINCT ACCESSION_NUMBER) as Number_of_Funds,
        SUM(CAST(CURRENCY_VALUE AS FLOAT)) as Total_Value
    FROM 
        FUND_REPORTED_HOLDING
    WHERE 
        ISSUER_CUSIP IS NOT NULL
    GROUP BY 
        ISSUER_CUSIP
)
SELECT 
    ISSUER_CUSIP,
    Usage_Count,
    Number_of_Funds,
    Total_Value
FROM 
    CUSIPFrequency
ORDER BY 
    Usage_Count DESC
LIMIT 1;","1","Success"
"What's the average coupon rate for investment-grade vs high-yield bonds?","WITH BondRates AS (
    SELECT 
        d.QUARTER,
        h.FAIR_VALUE_LEVEL,
        AVG(CAST(d.ANNUALIZED_RATE AS FLOAT)) as Avg_Coupon_Rate,
        COUNT(DISTINCT h.HOLDING_ID) as Number_of_Bonds,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Total_Value
    FROM 
        DEBT_SECURITY d
        JOIN FUND_REPORTED_HOLDING h ON d.HOLDING_ID = h.HOLDING_ID
    WHERE 
        d.ANNUALIZED_RATE IS NOT NULL
    GROUP BY 
        d.QUARTER,
        h.FAIR_VALUE_LEVEL
)
SELECT 
    QUARTER,
    FAIR_VALUE_LEVEL,
    ROUND(Avg_Coupon_Rate, 2) as Average_Coupon,
    Number_of_Bonds,
    Total_Value
FROM 
    BondRates;","3","Success"
"What's the distribution of bond ratings across different maturities?","WITH BondDistribution AS (
    SELECT 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL,
        CASE 
            WHEN d.MATURITY_DATE <= DATE('now', '+1 year') THEN 'Short_Term'
            WHEN d.MATURITY_DATE <= DATE('now', '+5 year') THEN 'Medium_Term'
            ELSE 'Long_Term'
        END as Maturity_Band,
        COUNT(*) as Bond_Count,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Total_Value
    FROM 
        FUND_REPORTED_HOLDING h
        JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
    WHERE 
        d.MATURITY_DATE IS NOT NULL
        AND h.FAIR_VALUE_LEVEL IS NOT NULL
    GROUP BY 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL,
        Maturity_Band
)
SELECT 
    FAIR_VALUE_LEVEL,
    Maturity_Band,
    Bond_Count,
    Total_Value
FROM 
    BondDistribution;","5","Success"
"Track changes in high-yield vs investment-grade allocation","WITH BondAllocation AS (
    SELECT 
        QUARTER,
        SUM(CAST(CREDIT_SPREAD_10YR_INVEST AS FLOAT)) as Investment_Grade_Exposure,
        SUM(CAST(CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)) as High_Yield_Exposure
    FROM 
        FUND_REPORTED_INFO
    WHERE 
        CREDIT_SPREAD_10YR_INVEST IS NOT NULL
        OR CREDIT_SPREAD_10YR_NONINVEST IS NOT NULL
    GROUP BY 
        QUARTER
)
SELECT 
    QUARTER,
    Investment_Grade_Exposure,
    High_Yield_Exposure,
    Investment_Grade_Exposure * 100.0 / (Investment_Grade_Exposure + High_Yield_Exposure)
FROM 
    BondAllocation
ORDER BY 
    QUARTER DESC;","1","Success"
"Track bond default rates and interest payment issues by credit rating","WITH DefaultMetrics AS (
    SELECT 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL,
        COUNT(DISTINCT h.HOLDING_ID) as Total_Bonds,
        COUNT(DISTINCT CASE WHEN d.IS_DEFAULT = 'Y' THEN h.HOLDING_ID END) as Defaulted_Bonds,
        COUNT(DISTINCT CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN h.HOLDING_ID END) as Missed_Payments,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Total_Value
    FROM 
        FUND_REPORTED_HOLDING h
        JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
    WHERE 
        h.FAIR_VALUE_LEVEL IS NOT NULL
    GROUP BY 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL
)
SELECT 
    QUARTER,
    FAIR_VALUE_LEVEL,
    Total_Bonds,
    Defaulted_Bonds,
    Missed_Payments,
    ROUND(Total_Value / 1000000, 2) as Value_Millions,
    ROUND(Defaulted_Bonds * 100.0 / NULLIF(Total_Bonds, 0), 2) as Default_Rate,
    ROUND(Missed_Payments * 100.0 / NULLIF(Total_Bonds, 0), 2) as Missed_Payment_Rate
FROM 
    DefaultMetrics
WHERE 
    Total_Bonds >= 10
ORDER BY 
    QUARTER DESC,
    FAIR_VALUE_LEVEL;","2","Success"
"Compare fixed vs floating rate bond distribution across credit qualities","WITH BondTypes AS (
    SELECT 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL,
        d.COUPON_TYPE,
        COUNT(DISTINCT h.HOLDING_ID) as Number_of_Bonds,
        SUM(CAST(h.CURRENCY_VALUE AS FLOAT)) as Total_Value,
        AVG(CAST(d.ANNUALIZED_RATE AS FLOAT)) as Average_Rate
    FROM 
        FUND_REPORTED_HOLDING h
        JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
    WHERE 
        h.FAIR_VALUE_LEVEL IS NOT NULL
        AND d.COUPON_TYPE IS NOT NULL
    GROUP BY 
        h.QUARTER,
        h.FAIR_VALUE_LEVEL,
        d.COUPON_TYPE
),
QuarterlyTotals AS (
    SELECT 
        QUARTER,
        FAIR_VALUE_LEVEL,
        SUM(Total_Value) as Total_Value_By_Rating
    FROM 
        BondTypes
    GROUP BY 
        QUARTER,
        FAIR_VALUE_LEVEL
)
SELECT 
    b.FAIR_VALUE_LEVEL,
    b.COUPON_TYPE,
    b.Number_of_Bonds,
    b.Total_Value,
    b.Total_Value * 100.0 / qt.Total_Value_By_Rating
FROM 
    BondTypes b
    JOIN QuarterlyTotals qt ON b.QUARTER = qt.QUARTER 
        AND b.FAIR_VALUE_LEVEL = qt.FAIR_VALUE_LEVEL;","9","Success"
"What's the liquidity profile of funds?","WITH LiquidityMetrics AS (
    SELECT 
        f.QUARTER,
        f.SERIES_NAME,
        CAST(f.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) as Cash,
        CAST(f.BORROWING_PAY_WITHIN_1YR AS FLOAT) as Short_Term_Obligations,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO f
    WHERE 
        f.CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
        AND f.TOTAL_ASSETS > 0
)
SELECT 
    QUARTER,
    SERIES_NAME,
    Cash,
    Cash * 100.0 / Total_Assets,
    Cash / NULLIF(Short_Term_Obligations, 0)
FROM 
    LiquidityMetrics;","4223","Success"
"Which funds have the highest interest rate sensitivity?","WITH InterestRateSensitivity AS (
    SELECT 
        f.QUARTER,
        r.REGISTRANT_NAME,
        f.SERIES_NAME,
        CAST(ir.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) as DV01_10Y,
        CAST(ir.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) as DV01_30Y,
        CAST(f.TOTAL_ASSETS AS FLOAT) as Total_Assets
    FROM 
        FUND_REPORTED_INFO f
        JOIN REGISTRANT r ON f.ACCESSION_NUMBER = r.ACCESSION_NUMBER
        JOIN INTEREST_RATE_RISK ir ON f.ACCESSION_NUMBER = ir.ACCESSION_NUMBER
    WHERE 
        ir.INTRST_RATE_CHANGE_10YR_DV01 IS NOT NULL
        OR ir.INTRST_RATE_CHANGE_30YR_DV01 IS NOT NULL
)
SELECT 
    QUARTER,
    REGISTRANT_NAME,
    SERIES_NAME,
    DV01_10Y,
    DV01_30Y,
    Total_Assets
FROM 
    InterestRateSensitivity
ORDER BY 
    (DV01_10Y + DV01_30Y) DESC
LIMIT 1;","1","Success"
"How has fund leverage changed over time?","WITH LeverageMetrics AS (
    SELECT 
        QUARTER,
        COUNT(DISTINCT SERIES_NAME) as Total_Funds,
        AVG(CAST(BORROWING_PAY_WITHIN_1YR AS FLOAT) + 
            CAST(BORROWING_PAY_AFTER_1YR AS FLOAT)) as Avg_Borrowing,
        MAX(CAST(BORROWING_PAY_WITHIN_1YR AS FLOAT) + 
            CAST(BORROWING_PAY_AFTER_1YR AS FLOAT)) as Max_Borrowing,
        AVG(CAST(TOTAL_ASSETS AS FLOAT)) as Avg_Assets
    FROM 
        FUND_REPORTED_INFO
    WHERE 
        BORROWING_PAY_WITHIN_1YR IS NOT NULL
        AND BORROWING_PAY_AFTER_1YR IS NOT NULL
    GROUP BY 
        QUARTER
)
SELECT 
    QUARTER,
    Total_Funds,
    Avg_Borrowing,
    Max_Borrowing,
    Avg_Borrowing / Avg_Assets * 100,
FROM 
    LeverageMetrics
ORDER BY 
    QUARTER DESC;","0","Failed: near ""FROM"": syntax error"
"Find the top 5 registrants with the highest average fund size across states","WITH FundSizes AS (
    SELECT 
        R.REGISTRANT_NAME,
        R.STATE,
        AVG(CAST(F.TOTAL_ASSETS AS FLOAT)) AS Avg_Fund_Size
    FROM 
        REGISTRANT R
    JOIN 
        FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY 
        R.REGISTRANT_NAME, R.STATE
),
StateAverages AS (
    SELECT 
        STATE,
        REGISTRANT_NAME,
        Avg_Fund_Size
    FROM 
        FundSizes
    WHERE 
        Avg_Fund_Size IS NOT NULL
)
SELECT 
    REGISTRANT_NAME,
    STATE,
    Avg_Fund_Size
FROM 
    StateAverages
ORDER BY 
    Avg_Fund_Size DESC
LIMIT 5;","5","Success"
"Identify funds with liabilities exceeding half their assets across registrants","WITH FundDebtRatios AS (
    SELECT 
        R.REGISTRANT_NAME,
        F.SERIES_NAME,
        CAST(F.TOTAL_LIABILITIES AS FLOAT) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) AS Debt_Ratio
    FROM 
        REGISTRANT R
    JOIN 
        FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE 
        F.TOTAL_ASSETS > 0
),
HighDebtFunds AS (
    SELECT 
        REGISTRANT_NAME,
        SERIES_NAME,
        Debt_Ratio
    FROM 
        FundDebtRatios
    WHERE 
        Debt_Ratio > 0.5
)
SELECT 
    REGISTRANT_NAME,
    SERIES_NAME,
    Debt_Ratio
FROM 
    HighDebtFunds;","53","Success"
"Find the registrants whose funds collectively hold over $10 billion in equity investments","WITH EquityInvestments AS (
    SELECT 
        R.REGISTRANT_NAME,
        SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) AS Total_Equity_Value
    FROM 
        REGISTRANT R
    JOIN 
        FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN 
        FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    WHERE 
        H.ASSET_CAT LIKE '%EQUITY%'
    GROUP BY 
        R.REGISTRANT_NAME
),
LargeRegistrants AS (
    SELECT 
        REGISTRANT_NAME,
        Total_Equity_Value
    FROM 
        EquityInvestments
    WHERE 
        Total_Equity_Value > 10000000000
)
SELECT 
    REGISTRANT_NAME,
    Total_Equity_Value
FROM 
    LargeRegistrants;","0","Success"
"List registrants whose funds' liabilities are distributed unevenly, with at least one fund having liabilities exceeding twice the average of their other funds.","WITH RegistrantFundStats AS (
    SELECT 
        R.REGISTRANT_NAME,
        F.SERIES_NAME,
        CAST(F.TOTAL_LIABILITIES AS FLOAT) AS Fund_Liabilities,
        AVG(CAST(F.TOTAL_LIABILITIES AS FLOAT)) OVER (PARTITION BY R.REGISTRANT_NAME) AS Avg_Liabilities
    FROM 
        REGISTRANT R
    JOIN 
        FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE 
        F.TOTAL_LIABILITIES IS NOT NULL
),
UnevenFunds AS (
    SELECT 
        REGISTRANT_NAME,
        SERIES_NAME,
        Fund_Liabilities,
        Avg_Liabilities
    FROM 
        RegistrantFundStats
    WHERE 
        Fund_Liabilities > 2 * Avg_Liabilities
)
SELECT 
    REGISTRANT_NAME,
    SERIES_NAME,
    Fund_Liabilities,
    Avg_Liabilities
FROM 
    UnevenFunds;","548","Success"
"Rank funds based on the consistency of their monthly returns, with the top 10 having the lowest variance.","WITH FundReturns AS (
    SELECT 
        F.SERIES_NAME,
        CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) AS Return1,
        CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) AS Return2,
        CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT) AS Return3
    FROM 
        FUND_REPORTED_INFO F
    JOIN 
        MONTHLY_TOTAL_RETURN M ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
    WHERE 
        M.MONTHLY_TOTAL_RETURN1 IS NOT NULL 
        AND M.MONTHLY_TOTAL_RETURN2 IS NOT NULL 
        AND M.MONTHLY_TOTAL_RETURN3 IS NOT NULL
),
VarianceCalculation AS (
    SELECT 
        SERIES_NAME,
        (POWER(Return1 - (Return1 + Return2 + Return3) / 3, 2) +
         POWER(Return2 - (Return1 + Return2 + Return3) / 3, 2) +
         POWER(Return3 - (Return1 + Return2 + Return3) / 3, 2)) / 3 AS Variance
    FROM 
        FundReturns
)
SELECT 
    SERIES_NAME,
    Variance
FROM 
    VarianceCalculation
ORDER BY 
    Variance ASC
LIMIT 10;","0","Failed: no such function: POWER"
"Find funds where at least one holding's value exceeds 20% of the total assets of the fund.","WITH FundHoldings AS (
    SELECT 
        F.SERIES_NAME,
        F.TOTAL_ASSETS,
        H.CURRENCY_VALUE
    FROM 
        FUND_REPORTED_INFO F
    JOIN 
        FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    WHERE 
        F.TOTAL_ASSETS IS NOT NULL
        AND H.CURRENCY_VALUE IS NOT NULL
),
HoldingPercentage AS (
    SELECT 
        SERIES_NAME,
        CURRENCY_VALUE,
        TOTAL_ASSETS,
        CAST(CURRENCY_VALUE AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) AS Holding_Percentage
    FROM 
        FundHoldings
),
FlaggedFunds AS (
    SELECT 
        SERIES_NAME
    FROM 
        HoldingPercentage
    WHERE 
        Holding_Percentage > 0.2
    GROUP BY 
        SERIES_NAME
)
SELECT 
    SERIES_NAME
FROM 
    FlaggedFunds;","20","Success"
"Find funds whose holdings include assets from at least 5 different countries and where total assets exceed $500M.","WITH FundCountryDiversity AS (
    SELECT 
        F.SERIES_NAME,
        F.TOTAL_ASSETS,
        COUNT(DISTINCT H.INVESTMENT_COUNTRY) AS Country_Count
    FROM 
        FUND_REPORTED_INFO F
    JOIN 
        FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    WHERE 
        H.INVESTMENT_COUNTRY IS NOT NULL
        AND F.TOTAL_ASSETS IS NOT NULL
    GROUP BY 
        F.SERIES_NAME, F.TOTAL_ASSETS
),
EligibleFunds AS (
    SELECT 
        SERIES_NAME,
        TOTAL_ASSETS,
        Country_Count
    FROM 
        FundCountryDiversity
    WHERE 
        Country_Count >= 5
        AND CAST(TOTAL_ASSETS AS FLOAT) > 500000000
)
SELECT 
    SERIES_NAME,
    TOTAL_ASSETS,
    Country_Count
FROM 
    EligibleFunds
ORDER BY 
    TOTAL_ASSETS DESC;","5","Success"
