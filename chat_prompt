# may need to define functions: reasonings_schema_json, final_output_schema_json, get_columns_info

# Define the latest available time period for data querying
latest_time_period = "2024Y"

# Background and Table Structure
overall_task_instructions = f"""
```
Task:
```
The task is to convert the natural language query into a SQL query. 
This involves parsing the intent of the query and understanding the structure of the data to generate an appropriate SQL command.
```
"""

# The table name being queried in this case
table_name = 'Joined'
table_name_instructions = f"""
```
SQL Table:
```
There is only one table to be queried: The {table_name} table.
```
"""

# A detailed overview of the table to help guide the model on what the table contains and how to reference it
# Saved Description for whole data set: Table Overview: 
# - This table holds security holdings of insurance companies, categorized by asset classes, and the information is present for each of a different set of time periods.
# - The security name in which the insurance company holds the investment, the amount invested in each holding, the sector of the holding, etc., are associated with the table.
# - Each row in the table represents a specific holding tied to a unique combination of these factors and a specific time period.
table_overview_instructions = f"""
```
Table Overview:
```
- The Joined table contains information from two sources: EDGAR submission and registrant data from the second quarter of 2024. Each row is uniquely identified by the primary key ACCESSION_NUMBER.
- Each row in the Joined table represents a unique filing (identified by the ACCESSION_NUMBER) and contains combined information about both the submission itself (from the SUBMISSION table) and the registrant (from the REGISTRANT table). 
- For each SEC filing, the table links submission-specific details with the corresponding registrant's identifying information.
```
The joined table contains information from two main sources:

- SUBMISSION: This table holds details about EDGAR submissions, with each row identified by the ACCESSION_NUMBER, which is a 20-character string. 
It includes information about filing dates, submission types (e.g., NPORT-P, NPORT-P/A), fiscal year-end dates, and whether a filing is the fund's last one on Form N-PORT.

- REGISTRANT: This table provides information about the entity (registrant) making the submission, also tied to the ACCESSION_NUMBER. 
It includes details such as the CIK number, registrant name, file number under the Investment Company Act, and the Legal Entity Identifier (LEI) of the registrant, as well as the detailed Address and Phone number of the registrant.
```
"""

# Instructions about how to handle specific parts of the natural language query
nlp_query_handling_instructions = f"""
Natural Language Processing Instructions:
- Break down the user's query to understand which asset classes, sectors, time periods, or specific security holdings they are asking for.
- Look for keywords related to amounts invested, sectors, and specific time periods.
- Extract time periods, sectors, and security names where explicitly mentioned, and default to the latest time period (2024Y) if no specific time period is provided.
"""

# The SQL Query Format template to guide the generated SQL command
sql_query_template_instructions = f"""
SQL Query Format:
- The table should be queried using the format:
    SELECT [columns] 
    FROM 'SNFOEVPIN.CSA_FIG_LTV_OWN_RPT_SP_SNL_INS_INV_HOLDING_FACT' 
    WHERE [conditions]
- [columns] should be replaced with the relevant column names the query intends to extract.
- [conditions] should be derived from the user query, specifically filtering by sectors, time periods, or amounts invested.
"""

# Define any default behavior if certain fields or conditions are not explicitly specified in the natural language query
default_query_instructions = f"""
Default Behavior:
- If no time period is specified, assume the most recent one (latest_time_period: {latest_time_period}).
- If no asset class or sector is mentioned, assume the user is asking for all available asset classes.
- Return all security holdings if no specific holding or sector is mentioned.
"""

# Final prompt to send to the model
full_prompt = overall_task_instructions + table_name_instructions + table_overview_instructions + nlp_query_handling_instructions + sql_query_template_instructions + default_query_instructions

# Print or return this full prompt to be sent to the ChatGPT API for processing
print(full_prompt)