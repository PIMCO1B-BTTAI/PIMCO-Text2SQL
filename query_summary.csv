"Question","SQL","Result_Count","Status"
"Show me the top 20 largest funds by total assets","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 20;","20","Success"
"List all funds with net assets over 1 billion dollars","SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(NET_ASSETS AS FLOAT) > 1000000000;","1608","Success"
"Which asset categories have the highest total investment value?","SELECT 
    ASSET_CAT,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING
GROUP BY 
    ASSET_CAT
ORDER BY 
    SUM(CAST(CURRENCY_VALUE AS FLOAT)) DESC
LIMIT 1;","1","Success"
"Show me the largest bond funds","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%BOND%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me the phone numbers of all Vanguard registrants","SELECT 
    REGISTRANT_NAME,
    PHONE 
FROM 
    REGISTRANT 
WHERE 
    REGISTRANT_NAME LIKE '%VANGUARD%';","127","Success"
"Which funds have assets between 100M and 500M?","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(TOTAL_ASSETS AS FLOAT) BETWEEN 100000000 AND 500000000;","1090","Success"
"List all registrants and their cities","SELECT 
    REGISTRANT_NAME,
    CITY
FROM 
    REGISTRANT;","4084","Success"
"Which funds have total assets equal to net assets?","SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS = NET_ASSETS;","1","Success"
"List all funds with 'Income' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INCOME%';","620","Success"
"Which funds have the highest liabilities to assets ratio?","SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS != '0'
ORDER BY 
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me all funds with 'Growth' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%GROWTH%';","338","Success"
"List the top 10 funds by net assets","SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
ORDER BY 
    CAST(NET_ASSETS AS FLOAT) DESC 
LIMIT 10;","10","Success"
"Which funds have zero liabilities?","SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;","1","Success"
"Which funds have the most cash on hand?","SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) DESC
LIMIT 1;","1","Success"
"Show me the smallest 5 funds by total assets","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS IS NOT NULL
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) ASC 
LIMIT 5;","5","Success"
"Which registrants have multiple phone numbers?","SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT PHONE)
FROM 
    REGISTRANT
GROUP BY 
    REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT PHONE) > 1;","6","Success"
"Show me all registrants from Florida","SELECT 
    REGISTRANT_NAME,
    CITY,
    ADDRESS1 
FROM 
    REGISTRANT 
WHERE 
    STATE = 'FL';","0","Success"
"Show me funds with the highest ratio of cash to total assets","SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL 
    AND TOTAL_ASSETS > 0
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;","1","Success"
"List all funds with 'Index' in their name","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INDEX%';","371","Success"
"List all registrants with their ZIP codes","SELECT 
    REGISTRANT_NAME,
    ZIP
FROM 
    REGISTRANT;","4084","Success"
"Show me all equity-focused funds","SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%EQUITY%'
    OR SERIES_NAME LIKE '%STOCK%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC;","418","Success"
"List all registrants with their country","SELECT 
    REGISTRANT_NAME,
    COUNTRY
FROM 
    REGISTRANT;","4084","Success"
"I'm looking for any funds with 'sustainable' or 'ESG' in their name what's their total AUM?","SELECT 
    COUNT(*),
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%SUSTAINABLE%'
    OR SERIES_NAME LIKE '%ESG%';","1","Success"
"Could you check which states have the most fund registrants? Top 5 is fine.","SELECT 
    STATE,
    COUNT(DISTINCT REGISTRANT_NAME)
FROM 
    REGISTRANT
GROUP BY 
    STATE
ORDER BY 
    COUNT(DISTINCT REGISTRANT_NAME) DESC
LIMIT 5;","5","Success"
"Which registrants are based in California?","SELECT 
    DISTINCT REGISTRANT_NAME
FROM 
    REGISTRANT 
WHERE 
    STATE = 'US-CA';","99","Success"
"List all funds with no reported liabilities.","SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;","1","Success"
"Show me all interest rate risks with a 3-month DV01 value exceeding 1 million","SELECT 
    ACCESSION_NUMBER,
    INTRST_RATE_CHANGE_3MON_DV01 
FROM 
    INTEREST_RATE_RISK 
WHERE 
    CAST(INTRST_RATE_CHANGE_3MON_DV01 AS FLOAT) > 1000000;","2","Success"
"Show the total investment values grouped by currency code.","SELECT 
    CURRENCY_CODE,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING 
GROUP BY 
    CURRENCY_CODE;","15","Success"
"List all borrowers with an aggregate value over 200 million.","SELECT 
    NAME,
    AGGREGATE_VALUE 
FROM 
    BORROWER 
WHERE 
    CAST(AGGREGATE_VALUE AS FLOAT) > 200000000;","129","Success"
"Which funds have unrealized appreciation in nonforeign currency swaps exceeding $10 million?","SELECT 
    HOLDING_ID,
    UNREALIZED_APPRECIATION 
FROM 
    NONFOREIGN_EXCHANGE_SWAP 
WHERE 
    CAST(UNREALIZED_APPRECIATION AS FLOAT) > 10000000;","0","Success"
"List all funds with a liquidation preference exceeding $1 billion.","SELECT 
    SERIES_NAME,
    LIQUIDATION_PREFERENCE 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(LIQUIDATION_PREFERENCE AS FLOAT) > 1000000000;","4","Success"
"Show me all debt securities with an annualized rate above 5%.","SELECT 
    HOLDING_ID,
    ANNUALIZED_RATE 
FROM 
    DEBT_SECURITY 
WHERE 
    CAST(ANNUALIZED_RATE AS FLOAT) > 5.0;","1835","Success"
"Show all holding records with a balance over 1,000.","SELECT 
    ISSUER_NAME,
    BALANCE 
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    CAST(BALANCE AS FLOAT) > 1000;","8899","Success"
"Show all funds with non-cash collateral flagged as true.","SELECT 
    SERIES_NAME,
    IS_NON_CASH_COLLATERAL 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    IS_NON_CASH_COLLATERAL = 'Y';","514","Success"
"List all registrants reporting from countries other than the United States.","SELECT 
    REGISTRANT_NAME
FROM 
    REGISTRANT 
WHERE 
    COUNTRY != 'United States';","4084","Success"
"Show all issuers categorized as DBT securities.","SELECT 
    ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    ASSET_CAT = 'DBT';","3571","Success"
"Find all funds where redemption flows in the second month are zero.","SELECT 
    SERIES_NAME
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(REDEMPTION_FLOW_MON2 AS FLOAT) = 0;","732","Success"
"Show all funds with cash not reported exceeding total liabilities.","SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D,
    TOTAL_LIABILITIES 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) > CAST(TOTAL_LIABILITIES AS FLOAT);","604","Success"
"Show all issuers with restricted securities.","SELECT 
    ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    IS_RESTRICTED_SECURITY = 'Y';","365","Success"
"Find all funds where monthly sales flow for the second month is positive.","SELECT 
    SERIES_NAME,
    SALES_FLOW_MON2 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(SALES_FLOW_MON2 AS FLOAT) > 0;","3550","Success"
"How many funds does each registrant have?","SELECT 
    REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;","1039","Success"
"What are the total assets of BlackRock funds?","SELECT 
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';","1","Success"
"List all funds with their registrant names","SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;","4084","Success"
"What's the latest filing date for each fund?","SELECT 
    F.SERIES_NAME,
    MAX(S.FILING_DATE)
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME;","3881","Success"
"Show me the earliest filing date for each registrant","SELECT 
    R.REGISTRANT_NAME,
    MIN(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;","1039","Success"
"List all registrants with their fund count and total assets","SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME),
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;","1039","Success"
"Show me all Fidelity funds","SELECT 
    F.SERIES_NAME,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%FIDELITY%';","187","Success"
"List all registrants with their latest fund's assets","SELECT 
    R.REGISTRANT_NAME,
    F.TOTAL_ASSETS
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;","4084","Success"
"List all funds with their submission dates","SELECT 
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER;","4084","Success"
"Show me the registrants with the most recent filings","SELECT 
    R.REGISTRANT_NAME,
    MAX(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    MAX(S.FILING_DATE) DESC
LIMIT 1;","1","Success"
"Find out which investment firms manage the most diverse portfolio of fund types?","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;","1","Success"
"I need to check which funds may be too concentrated - find ones where a single holding is more than 10% of their portfolio?","SELECT 
    F.SERIES_NAME,
    H.ISSUER_NAME,
    H.PERCENTAGE
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    CAST(H.PERCENTAGE AS FLOAT) > 10.0;","31","Success"
"Check which investment firms have the most diverse geographic exposure in their holdings","SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT H.INVESTMENT_COUNTRY),
    COUNT(DISTINCT H.HOLDING_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.INVESTMENT_COUNTRY IS NOT NULL
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) DESC
LIMIT 1;","1","Success"
"Find me funds that might be too exposed to interest rate changes - check their duration risk","SELECT 
    SERIES_NAME,
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT),
    CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 1.0
    OR CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 1.0;","1895","Success"
"I need to find funds with strong and consistent returns over all three months","SELECT 
    F.SERIES_NAME,
    M.MONTHLY_TOTAL_RETURN1,
    M.MONTHLY_TOTAL_RETURN2,
    M.MONTHLY_TOTAL_RETURN3,
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT) > 0
ORDER BY 
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3 DESC;","2192","Success"
"Show me which asset categories had the best returns last month?","SELECT 
    H.ASSET_CAT,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F 
        ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    H.ASSET_CAT
ORDER BY 
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)) DESC
LIMIT 1;","1","Success"
"Which investment companies are most exposed to international markets?","SELECT 
    R.REGISTRANT_NAME,
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END),
    COUNT(*),
    SUM(CASE WHEN H.INVESTMENT_COUNTRY != 'US' 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) ELSE 0 END)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    COUNT(*) > 10
ORDER BY 
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END) DESC
LIMIT 1;","1","Success"
"Help me find funds that might be too concentrated in specific sectors","SELECT 
    F.SERIES_NAME,
    H.ASSET_CAT,
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    F.SERIES_NAME, H.ASSET_CAT, F.TOTAL_ASSETS
ORDER BY 
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100 DESC;","4804","Success"
"Which funds are taking on the most interest rate risk?","SELECT 
    F.SERIES_NAME,
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) DESC
LIMIT 1;","1","Success"
"Identify funds with highest portfolio turnover based on their trading activity?","SELECT 
    F.SERIES_NAME,
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SALES_FLOW_MON1 IS NOT NULL 
    AND F.SALES_FLOW_MON2 IS NOT NULL 
    AND F.SALES_FLOW_MON3 IS NOT NULL
GROUP BY 
    F.SERIES_NAME, F.TOTAL_ASSETS
HAVING 
    F.TOTAL_ASSETS > 0
ORDER BY 
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC
LIMIT 1;","1","Success"
"See which fund families are most active in securities lending","SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    LEFT JOIN SECURITIES_LENDING SL 
        ON F.ACCESSION_NUMBER = SL.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME)) DESC
LIMIT 1;","1","Success"
"How many funds does each investment company manage?","SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT SERIES_NAME),
    COUNT(DISTINCT SERIES_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;","1039","Success"
"Which USD funds are most exposed to interest rate changes?","SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    IR.CURRENCY_CODE = 'USD'
    AND (
        CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 100000
        OR CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 100000
    )
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) DESC
LIMIT 1;","1","Success"
"What's our exposure by state? Need to check geographic concentration.","SELECT 
    R.STATE,
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.STATE IS NOT NULL
GROUP BY 
    R.STATE;","41","Success"
"Which securities are most actively lent out?","SELECT 
    H.ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING H
    JOIN SECURITIES_LENDING SL ON H.HOLDING_ID = SL.HOLDING_ID
WHERE 
    SL.IS_LOAN_BY_FUND = 'Y'
GROUP BY 
    H.ISSUER_NAME
HAVING 
    COUNT(*) > 1
ORDER BY 
    COUNT(*) DESC,
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) DESC
LIMIT 1;","1","Success"
"Let's look at convertible securities with high conversion ratios - could be significant upside.","SELECT 
    F.SERIES_NAME,
    CSC.CONVERSION_RATIO
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN CONVERTIBLE_SECURITY_CURRENCY CSC ON H.HOLDING_ID = CSC.HOLDING_ID
WHERE 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) > 1
ORDER BY 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) DESC;","0","Success"
"What percentage of bonds have missed interest payments by sector?","SELECT
    h.ISSUER_TYPE,
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*))
FROM 
    FUND_REPORTED_HOLDING h
    JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
WHERE 
    h.ISSUER_TYPE IS NOT NULL
GROUP BY 
    h.ISSUER_TYPE
ORDER BY 
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*)) DESC;","7","Success"
"List all funds and their associated registrants, sorted by filing date","SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
    JOIN SUBMISSION S ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
ORDER BY 
    S.FILING_DATE DESC;","4084","Success"
"What are the average total assets per state?","SELECT 
    R.STATE,
    AVG(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.STATE IS NOT NULL
GROUP BY 
    R.STATE;","41","Success"
"List all funds managed by registrants in California.","SELECT 
    F.SERIES_NAME,
    R.REGISTRANT_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.STATE = 'US-CA';","481","Success"
"Which registrants are most active in convertible securities?","SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_HOLDING F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN CONVERTIBLE_SECURITY_CURRENCY CSC ON F.HOLDING_ID = CSC.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(CSC.CONVERTIBLE_SECURITY_ID) DESC
LIMIT 1;","0","Success"
"Show funds exposed to non-cash collateral.","SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    F.IS_NON_CASH_COLLATERAL = 'Y';","514","Success"
"Which funds have the highest number of holdings?","SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY 
    COUNT(H.HOLDING_ID) DESC
LIMIT 1;","1","Success"
"List all funds managed by BlackRock and their total liabilities.","SELECT 
    F.SERIES_NAME,
    F.TOTAL_LIABILITIES
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';","100","Success"
"Identify funds managed by multiple registrants.","SELECT 
    F.SERIES_NAME,
    COUNT(DISTINCT R.REGISTRANT_NAME) AS REGISTRANT_COUNT
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
HAVING 
    COUNT(DISTINCT R.REGISTRANT_NAME) > 1;","50","Success"
"Which funds reported the highest borrowing within one year?","SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY
		MAX(CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT)) DESC
LIMIT 1;","1","Success"
"Find registrants with securities in multiple countries.","SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) > 1;","248","Success"
"Which registrants have zero liabilities but manage funds?","SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    F.TOTAL_LIABILITIES = '0'
GROUP BY 
    R.REGISTRANT_NAME;","1","Success"
"List all registrants along with the number of funds they manage.","SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;","1039","Success"
"Find funds whose total assets exceed the average total assets of all funds.","WITH AvgAssets AS (
    SELECT AVG(CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_TOTAL_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_ASSETS AS FLOAT) > (SELECT AVG_TOTAL_ASSETS FROM AvgAssets);","532","Success"
"List the top 5 registrants by fund count, excluding those with below-average counts.","WITH AvgFundCount AS (
    SELECT AVG(FUND_COUNT) AS AVG_COUNT
    FROM (SELECT REGISTRANT_NAME, COUNT(*) AS FUND_COUNT FROM REGISTRANT R
          JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
          GROUP BY REGISTRANT_NAME) Subquery
)
SELECT REGISTRANT_NAME, COUNT(*)
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY REGISTRANT_NAME
HAVING COUNT(*) > (SELECT AVG_COUNT FROM AvgFundCount)
ORDER BY COUNT(*) DESC
LIMIT 5;","5","Success"
"Show funds whose liabilities are more than twice the average liability of all funds.","WITH AvgLiabilities AS (
    SELECT AVG(CAST(TOTAL_LIABILITIES AS FLOAT)) AS AVG_LIABILITY
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > 2 * (SELECT AVG_LIABILITY FROM AvgLiabilities);","272","Success"
"Identify registrants whose states have the most funds.","WITH StateFundCount AS (
    SELECT STATE, COUNT(*) AS FUND_COUNT
    FROM REGISTRANT
    GROUP BY STATE
)
SELECT REGISTRANT_NAME, STATE
FROM REGISTRANT
WHERE STATE = (SELECT STATE FROM StateFundCount ORDER BY FUND_COUNT DESC LIMIT 1);","666","Success"
"Find funds whose total assets match the maximum total assets of their registrant's state.","WITH StateMaxAssets AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT SERIES_NAME, TOTAL_ASSETS, STATE
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM StateMaxAssets WHERE STATE = R.STATE);","41","Success"
"List the registrants whose funds account for more than 5% of total reported assets.","WITH TotalAssets AS (
    SELECT SUM(CAST(TOTAL_ASSETS AS FLOAT)) AS GLOBAL_TOTAL
    FROM FUND_REPORTED_INFO
)
SELECT REGISTRANT_NAME, SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY REGISTRANT_NAME
HAVING SUM(CAST(F.TOTAL_ASSETS AS FLOAT)) > 0.05 * (SELECT GLOBAL_TOTAL FROM TotalAssets);","2","Success"
"Find the largest fund for each registrant.","WITH LargestFunds AS (
    SELECT REGISTRANT_NAME, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, SERIES_NAME, TOTAL_ASSETS
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM LargestFunds WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);","1040","Success"
"Show funds with liabilities exceeding 90% of the largest liability among all funds.","WITH MaxLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_LIABILITY
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > 0.9 * (SELECT MAX_LIABILITY FROM MaxLiability);","1","Success"
"List funds whose net assets match their registrant's highest net asset fund.","WITH MaxNetAssets AS (
    SELECT REGISTRANT_NAME, MAX(CAST(NET_ASSETS AS FLOAT)) AS MAX_NET_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT SERIES_NAME, NET_ASSETS
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(NET_ASSETS AS FLOAT) = (SELECT MAX_NET_ASSETS FROM MaxNetAssets WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);","1040","Success"
"List registrants with above-average total assets in their state.","WITH StateAvgAssets AS (
    SELECT STATE, AVG(CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_STATE_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) > (SELECT AVG_STATE_ASSETS FROM StateAvgAssets WHERE STATE = R.STATE);","794","Success"
"Identify funds whose liabilities exceed the largest liability for any bond fund.","WITH MaxBondLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_BOND_LIABILITY FROM MaxBondLiability);","2","Success"
"Show registrants managing the largest fund in each state.","WITH LargestFundPerState AS (
    SELECT R.STATE, MAX(CAST(F.TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM LargestFundPerState WHERE STATE = R.STATE);","41","Success"
"Find the smallest fund for each registrant.","WITH SmallestFunds AS (
    SELECT REGISTRANT_NAME, MIN(CAST(TOTAL_ASSETS AS FLOAT)) AS MIN_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MIN_ASSETS FROM SmallestFunds WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);","1041","Success"
"List funds whose cash exceeds the average cash for their registrant.","WITH RegistrantAvgCash AS (
    SELECT REGISTRANT_NAME, AVG(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS AVG_CASH
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) > (SELECT AVG_CASH FROM RegistrantAvgCash WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);","844","Success"
"Show states with above-average registrant counts.","WITH AvgRegistrantsPerState AS (
    SELECT AVG(REG_COUNT) AS AVG_COUNT
    FROM (SELECT STATE, COUNT(*) AS REG_COUNT FROM REGISTRANT GROUP BY STATE) Subquery
)
SELECT STATE
FROM REGISTRANT
GROUP BY STATE
HAVING COUNT(*) > (SELECT AVG_COUNT FROM AvgRegistrantsPerState);","11","Success"
"Find funds with net assets exceeding the maximum for equity funds.","WITH MaxEquityNetAssets AS (
    SELECT MAX(CAST(NET_ASSETS AS FLOAT)) AS MAX_NET_ASSETS
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%'
)
SELECT SERIES_NAME, NET_ASSETS
FROM FUND_REPORTED_INFO
WHERE CAST(NET_ASSETS AS FLOAT) > (SELECT MAX_NET_ASSETS FROM MaxEquityNetAssets);","60","Success"
"List registrants managing the largest fund across all registrants.","WITH LargestFund AS (
    SELECT MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_TOTAL_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_TOTAL_ASSETS FROM LargestFund);","1","Success"
"Identify funds with liabilities less than the smallest liability for bond funds.","WITH MinBondLiability AS (
    SELECT MIN(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MIN_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) < (SELECT MIN_BOND_LIABILITY FROM MinBondLiability);","19","Success"
"Find the largest fund in each state.","WITH StateLargestFund AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT R.STATE, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM StateLargestFund WHERE STATE = R.STATE);","41","Success"
"Show funds with a percentage of their portfolio in cash exceeding 20%.","WITH CashPercentage AS (
    SELECT SERIES_NAME, (CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL AND CAST(TOTAL_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, CASH_RATIO
FROM CashPercentage
WHERE CASH_RATIO > 0.2;","22","Success"
"Identify funds with above-average monthly redemption flows.","WITH AvgRedemptionFlow AS (
    SELECT AVG(CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) AS AVG_FLOW
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, REDEMPTION_FLOW_MON1, REDEMPTION_FLOW_MON2, REDEMPTION_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) > (SELECT AVG_FLOW FROM AvgRedemptionFlow);","506","Success"
"Find registrants whose largest fund exceeds $1 billion in total assets.","WITH LargestFundPerRegistrant AS (
    SELECT REGISTRANT_NAME, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, MAX_ASSETS
FROM LargestFundPerRegistrant
WHERE MAX_ASSETS > 1000000000;","547","Success"
"Show funds with liabilities smaller than the smallest liability of any bond fund.","WITH MinBondFundLiability AS (
    SELECT MIN(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MIN_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) < (SELECT MIN_LIABILITY FROM MinBondFundLiability);","19","Success"
"Find the total cash held by registrants whose largest fund exceeds $500 million.","WITH RegistrantsWithLargeFunds AS (
    SELECT REGISTRANT_NAME
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
    HAVING MAX(CAST(F.TOTAL_ASSETS AS FLOAT)) > 500000000
)
SELECT R.REGISTRANT_NAME, SUM(CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS TOTAL_CASH
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE R.REGISTRANT_NAME IN (SELECT REGISTRANT_NAME FROM RegistrantsWithLargeFunds)
GROUP BY R.REGISTRANT_NAME;","701","Success"
"List funds that have a greater percentage of cash compared to any equity fund.","WITH MaxEquityCashRatio AS (
    SELECT MAX(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_EQUITY_CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%'
)
SELECT SERIES_NAME, CASH_NOT_RPTD_IN_C_OR_D, TOTAL_ASSETS
FROM FUND_REPORTED_INFO
WHERE CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) > (SELECT MAX_EQUITY_CASH_RATIO FROM MaxEquityCashRatio);","8","Success"
"Identify states with more than 10 registrants having net assets above the average.","WITH AvgNetAssets AS (
    SELECT AVG(CAST(NET_ASSETS AS FLOAT)) AS AVG_NET_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT R.STATE, COUNT(*) AS REGISTRANT_COUNT
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.NET_ASSETS AS FLOAT) > (SELECT AVG_NET_ASSETS FROM AvgNetAssets)
GROUP BY R.STATE
HAVING COUNT(*) > 10;","10","Success"
"Show registrants with the largest portfolio turnover ratio.","WITH PortfolioTurnover AS (
    SELECT REGISTRANT_NAME, 
           MAX((CAST(F.SALES_FLOW_MON1 AS FLOAT) + CAST(F.SALES_FLOW_MON2 AS FLOAT) + CAST(F.SALES_FLOW_MON3 AS FLOAT)) 
               / CAST(F.TOTAL_ASSETS AS FLOAT)) AS TURNOVER_RATIO
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, TURNOVER_RATIO
FROM PortfolioTurnover
ORDER BY TURNOVER_RATIO DESC
LIMIT 1;","1","Success"
"Find funds whose liabilities are larger than the average liabilities of bond funds.","WITH AvgBondLiability AS (
    SELECT AVG(CAST(TOTAL_LIABILITIES AS FLOAT)) AS AVG_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > (SELECT AVG_BOND_LIABILITY FROM AvgBondLiability);","323","Success"
"Identify states where the largest fund is managed by Vanguard.","WITH VanguardLargestFund AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE R.REGISTRANT_NAME LIKE '%VANGUARD%'
    GROUP BY STATE
)
SELECT STATE, MAX_ASSETS
FROM VanguardLargestFund;","1","Success"
"Find exisiting funds with the highest proportion of liabilities to net assets.","WITH LiabilityToNetAssets AS (
    SELECT SERIES_NAME, 
           (CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(NET_ASSETS AS FLOAT)) AS LIABILITY_RATIO
    FROM FUND_REPORTED_INFO
    WHERE CAST(NET_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, LIABILITY_RATIO
FROM LiabilityToNetAssets
WHERE SERIES_NAME != 'N/A'
ORDER BY LIABILITY_RATIO DESC
LIMIT 1;","1","Success"
"Identify funds with monthly sales flows larger than any ETF.","WITH MaxETFSalesFlow AS (
    SELECT MAX(CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) AS MAX_ETF_FLOW
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%ETF%'
)
SELECT SERIES_NAME, SALES_FLOW_MON1, SALES_FLOW_MON2, SALES_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) > (SELECT MAX_ETF_FLOW FROM MaxETFSalesFlow);","1","Success"
"Identify funds whose cash proportion is higher than the average cash proportion of equity funds.","WITH AvgEquityCashRatio AS (
    SELECT AVG(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%' AND CAST(TOTAL_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, CASH_NOT_RPTD_IN_C_OR_D, TOTAL_ASSETS
FROM FUND_REPORTED_INFO
WHERE (CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) > (SELECT AVG_CASH_RATIO FROM AvgEquityCashRatio);","592","Success"
"Show registrants managing funds with liabilities higher than any convertible security fund.","WITH MaxConvertibleLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_CONVERTIBLE_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%CONVERTIBLE%'
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_LIABILITIES
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_CONVERTIBLE_LIABILITY FROM MaxConvertibleLiability);","260","Success"
"List funds with monthly sales flows higher than the average for all funds.","WITH AvgSalesFlow AS (
    SELECT AVG(CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) AS AVG_SALES_FLOW
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, SALES_FLOW_MON1, SALES_FLOW_MON2, SALES_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) > (SELECT AVG_SALES_FLOW FROM AvgSalesFlow);","536","Success"
"Find funds with liabilities less than the average liabilities of all funds in their state.","WITH AvgStateLiability AS (
    SELECT R.STATE, AVG(CAST(F.TOTAL_LIABILITIES AS FLOAT)) AS AVG_LIABILITY
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT F.SERIES_NAME, F.TOTAL_LIABILITIES, R.STATE
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) < (SELECT AVG_LIABILITY FROM AvgStateLiability WHERE STATE = R.STATE);","3464","Success"
"Identify registrants managing funds with the highest cash proportion in their state.","WITH StateMaxCash AS (
    SELECT R.STATE, MAX(CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT)) AS MAX_CASH_RATIO
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE CAST(F.TOTAL_ASSETS AS FLOAT) > 0
    GROUP BY R.STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.SERIES_NAME, F.CASH_NOT_RPTD_IN_C_OR_D
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) = 
      (SELECT MAX_CASH_RATIO FROM StateMaxCash WHERE STATE = R.STATE);","43","Success"
"Find states with total liabilities higher than the average liabilities for all states.","WITH AvgStateLiability AS (
    SELECT R.STATE, AVG(CAST(F.TOTAL_LIABILITIES AS FLOAT)) AS AVG_STATE_LIABILITY
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT STATE
FROM AvgStateLiability
WHERE AVG_STATE_LIABILITY > (SELECT AVG(AVG_STATE_LIABILITY) FROM AvgStateLiability);","12","Success"
"Show registrants managing funds with liabilities larger than the maximum liabilities of any index fund.","WITH MaxIndexFundLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_INDEX_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%INDEX%'
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_LIABILITIES
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_INDEX_LIABILITY FROM MaxIndexFundLiability);","14","Success"
"Find funds whose redemption flows exceed the highest redemption flow for any bond fund.","WITH MaxBondRedemptionFlow AS (
    SELECT MAX(CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) AS MAX_BOND_FLOW
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, REDEMPTION_FLOW_MON1, REDEMPTION_FLOW_MON2, REDEMPTION_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) > (SELECT MAX_BOND_FLOW FROM MaxBondRedemptionFlow);","5","Success"
"List states with the highest average net assets per fund.","WITH StateAvgNetAssets AS (
    SELECT R.STATE, AVG(CAST(F.NET_ASSETS AS FLOAT)) AS AVG_NET_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE F.NET_ASSETS IS NOT NULL
    GROUP BY R.STATE
)
SELECT STATE, AVG_NET_ASSETS
FROM StateAvgNetAssets
WHERE AVG_NET_ASSETS = (SELECT MAX(AVG_NET_ASSETS) FROM StateAvgNetAssets);","1","Success"
