Ground_Truth_Query,LLM_Query,Comparison_Result
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 20;",Show me the top 20 largest funds by total assets,True
"SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(NET_ASSETS AS FLOAT) > 1000000000;",List all funds with net assets over 1 billion dollars,False
"SELECT 
    ASSET_CAT,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING
GROUP BY 
    ASSET_CAT
ORDER BY 
    SUM(CAST(CURRENCY_VALUE AS FLOAT)) DESC
LIMIT 1;",Which asset categories have the highest total investment value?,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%BOND%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;",Show me the largest bond funds,True
"SELECT 
    REGISTRANT_NAME,
    PHONE 
FROM 
    REGISTRANT 
WHERE 
    REGISTRANT_NAME LIKE '%VANGUARD%';",Show me the phone numbers of all Vanguard registrants,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(TOTAL_ASSETS AS FLOAT) BETWEEN 100000000 AND 500000000;",Which funds have assets between 100M and 500M?,False
"SELECT 
    REGISTRANT_NAME,
    CITY
FROM 
    REGISTRANT;",List all registrants and their cities,True
"SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS = NET_ASSETS;",Which funds have total assets equal to net assets?,True
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INCOME%';",List all funds with 'Income' in their name,False
"SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS != '0'
ORDER BY 
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;",Which funds have the highest liabilities to assets ratio?,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%GROWTH%';",Show me all funds with 'Growth' in their name,False
"SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
ORDER BY 
    CAST(NET_ASSETS AS FLOAT) DESC 
LIMIT 10;",List the top 10 funds by net assets,False
"SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;",Which funds have zero liabilities?,True
"SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) DESC
LIMIT 1;",Which funds have the most cash on hand?,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS IS NOT NULL
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) ASC 
LIMIT 5;",Show me the smallest 5 funds by total assets,True
"SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT PHONE)
FROM 
    REGISTRANT
GROUP BY 
    REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT PHONE) > 1;",Which registrants have multiple phone numbers?,False
"SELECT 
    REGISTRANT_NAME,
    CITY,
    ADDRESS1 
FROM 
    REGISTRANT 
WHERE 
    STATE = 'FL';",Show me all registrants from Florida,False
"SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL 
    AND TOTAL_ASSETS > 0
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;",Show me funds with the highest ratio of cash to total assets,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INDEX%';",List all funds with 'Index' in their name,False
"SELECT 
    REGISTRANT_NAME,
    ZIP
FROM 
    REGISTRANT;",List all registrants with their ZIP codes,True
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%EQUITY%'
    OR SERIES_NAME LIKE '%STOCK%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC;",Show me all equity-focused funds,False
"SELECT 
    REGISTRANT_NAME,
    COUNTRY
FROM 
    REGISTRANT;",List all registrants with their country,True
"SELECT 
    COUNT(*),
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%SUSTAINABLE%'
    OR SERIES_NAME LIKE '%ESG%';",I'm looking for any funds with 'sustainable' or 'ESG' in their name what's their total AUM?,False
"SELECT 
    STATE,
    COUNT(DISTINCT REGISTRANT_NAME)
FROM 
    REGISTRANT
GROUP BY 
    STATE
ORDER BY 
    COUNT(DISTINCT REGISTRANT_NAME) DESC
LIMIT 5;",Could you check which states have the most fund registrants? Top 5 is fine.,False
"SELECT 
    F.SERIES_NAME,
    SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)),
    SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.CREDIT_SPREAD_10YR_NONINVEST IS NOT NULL
GROUP BY 
    F.SERIES_NAME
HAVING 
    SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)) > SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT));",Find me funds that might be taking on too much credit risk - look at their non-investment grade holdings,False
"SELECT 
    F.SERIES_NAME,
    CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) / 
    NULLIF(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) + CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%FIXED INCOME%'
ORDER BY 
    CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) / 
    NULLIF(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT) + CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT), 0) * 100 DESC
LIMIT 1;",Show me the funds with the highest quality fixed income portfolios,False
"SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / NULLIF(CAST(BORROWING_PAY_WITHIN_1YR AS FLOAT), 0),
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO
WHERE 
    BORROWING_PAY_WITHIN_1YR > 0;",Looking for funds that might have liquidity issues - check their cash versus short-term obligations,False
"SELECT 
    F.SERIES_NAME,
    CAST(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) AS FLOAT) /
    NULLIF(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%FIXED INCOME%'
GROUP BY 
    F.SERIES_NAME
HAVING 
    SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)) > 0
ORDER BY 
    NULLIF(SUM(CAST(F.CREDIT_SPREAD_10YR_INVEST AS FLOAT)) + SUM(CAST(F.CREDIT_SPREAD_10YR_NONINVEST AS FLOAT)), 0) * 100 DESC
LIMIT 1;",Find funds with the highest quality fixed-income holdings,False
"SELECT 
    F.SERIES_NAME,
    (CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT) +
     CAST(F.BORROWING_PAY_AFTER_1YR AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.TOTAL_ASSETS > 0
ORDER BY 
    (CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT) +
     CAST(F.BORROWING_PAY_AFTER_1YR AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0) * 100 DESC;",Find funds that might be too leveraged through their borrowing activities,False
"SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) * 100,
    TOTAL_ASSETS,
    TOTAL_LIABILITIES
FROM 
    FUND_REPORTED_INFO
WHERE 
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) > 0.5;",Can you flag any funds that have liabilities over half their assets?,False
"SELECT 
    F.SERIES_NAME,
    F.NET_REALIZE_GAIN_NONDERIV_MON1,
    F.NET_REALIZE_GAIN_NONDERIV_MON2,
    F.NET_REALIZE_GAIN_NONDERIV_MON3,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
WHERE 
    CAST(NET_REALIZE_GAIN_NONDERIV_MON1 AS FLOAT) < 0
    OR CAST(NET_REALIZE_GAIN_NONDERIV_MON2 AS FLOAT) < 0
    OR CAST(NET_REALIZE_GAIN_NONDERIV_MON3 AS FLOAT) < 0;",Find any funds showing losses in their realized gains.,False
"SELECT 
    ISSUER_TYPE,
    FAIR_VALUE_LEVEL,
    COUNT(*),
    SUM(CAST(CURRENCY_VALUE AS FLOAT)),
    COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY ISSUER_TYPE)
FROM 
    FUND_REPORTED_HOLDING
WHERE 
    ISSUER_TYPE IS NOT NULL 
    AND FAIR_VALUE_LEVEL IS NOT NULL
GROUP BY 
    ISSUER_TYPE,
    FAIR_VALUE_LEVEL;",Give me a breakdown of holdings by fair value level and issuer type looking for valuation risk.,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS,
    LIQUIDATION_PREFERENCE,
    (CAST(LIQUIDATION_PREFERENCE AS FLOAT) / 
     NULLIF(CAST(TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO
WHERE 
    CAST(LIQUIDATION_PREFERENCE AS FLOAT) > 1000000
ORDER BY 
    (CAST(LIQUIDATION_PREFERENCE AS FLOAT) / 
     NULLIF(CAST(TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC;",Find funds with high liquidation preference relative to their size - might affect wind-down scenarios.,False
"SELECT 
    REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;",How many funds does each registrant have?,False
"SELECT 
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';",What are the total assets of BlackRock funds?,False
"SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;",List all funds with their registrant names,False
"SELECT 
    F.SERIES_NAME,
    MAX(S.FILING_DATE)
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME;",What's the latest filing date for each fund?,False
"SELECT 
    R.REGISTRANT_NAME,
    MIN(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;",Show me the earliest filing date for each registrant,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME),
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;",List all registrants with their fund count and total assets,False
"SELECT 
    F.SERIES_NAME,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%FIDELITY%';",Show me all Fidelity funds,False
"SELECT 
    R.REGISTRANT_NAME,
    F.TOTAL_ASSETS
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;",List all registrants with their latest fund's assets,False
"SELECT 
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER;",List all funds with their submission dates,True
"SELECT 
    R.REGISTRANT_NAME,
    MAX(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    MAX(S.FILING_DATE) DESC
LIMIT 1;",Show me the registrants with the most recent filings,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;",Find out which investment firms manage the most diverse portfolio of fund types?,False
"SELECT 
    F.SERIES_NAME,
    H.ISSUER_NAME,
    H.PERCENTAGE
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    CAST(H.PERCENTAGE AS FLOAT) > 10.0;",I need to check which funds may be too concentrated - find ones where a single holding is more than 10% of their portfolio?,False
"SELECT 
    CASE 
        WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'Bond'
        WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'Equity'
    END AS Fund_Type,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)),
    COUNT(*)
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    F.SERIES_NAME LIKE '%BOND%'
    OR F.SERIES_NAME LIKE '%EQUITY%'
GROUP BY 
    Fund_Type;",Compare how our bond funds performed against equity funds in the last month,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT H.INVESTMENT_COUNTRY),
    COUNT(DISTINCT H.HOLDING_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.INVESTMENT_COUNTRY IS NOT NULL
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) DESC
LIMIT 1;",Check which investment firms have the most diverse geographic exposure in their holdings,False
"SELECT 
    CASE 
        WHEN F.SERIES_NAME LIKE '%GROWTH%' THEN 'Growth'
        WHEN F.SERIES_NAME LIKE '%VALUE%' THEN 'Value'
        WHEN F.SERIES_NAME LIKE '%BLEND%' THEN 'Blend'
        ELSE 'Other'
    END AS Investment_Style,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)),
    COUNT(*)
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
GROUP BY 
    Investment_Style
HAVING 
    Investment_Style != 'Other'
ORDER BY 
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)) DESC
LIMIT 1;",Find which investment styles are performing best this quarter? Like growth vs value funds?,Error
"SELECT 
    SERIES_NAME,
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT),
    CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 1.0
    OR CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 1.0;",Find me funds that might be too exposed to interest rate changes - check their duration risk,False
"SELECT 
    F.SERIES_NAME,
    M.MONTHLY_TOTAL_RETURN1,
    M.MONTHLY_TOTAL_RETURN2,
    M.MONTHLY_TOTAL_RETURN3,
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT) > 0
ORDER BY 
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3 DESC;",I need to find funds with strong and consistent returns over all three months,False
"SELECT 
    F.SERIES_NAME,
    COUNT(DISTINCT H.CURRENCY_CODE),
    SUM(CASE 
        WHEN H.CURRENCY_CODE NOT IN ('USD', 'EUR', 'GBP', 'JPY', 'CHF') 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) 
        ELSE 0 
    END) as Emerging_Market_Exposure
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY 
    Emerging_Market_Exposure DESC
LIMIT 1;",Which funds have the most foreign currency exposure? Interested in emerging markets,False
"SELECT 
    H.ASSET_CAT,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F 
        ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    H.ASSET_CAT
ORDER BY 
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)) DESC
LIMIT 1;",Show me which asset categories had the best returns last month?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%BALANCED%' THEN 'BALANCED'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;",Which registrants have the most diverse mix of fund types in their lineup?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END),
    COUNT(*),
    SUM(CASE WHEN H.INVESTMENT_COUNTRY != 'US' 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) ELSE 0 END)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    COUNT(*) > 10
ORDER BY 
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END) DESC
LIMIT 1;",Which investment companies are most exposed to international markets?,False
"SELECT 
    F.SERIES_NAME,
    H.ASSET_CAT,
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    F.SERIES_NAME, H.ASSET_CAT, F.TOTAL_ASSETS
ORDER BY 
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100 DESC;",Help me find funds that might be too concentrated in specific sectors,False
"SELECT 
    F.SERIES_NAME,
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) DESC
LIMIT 1;",Which funds are taking on the most interest rate risk?,False
"SELECT 
    F.SERIES_NAME,
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SALES_FLOW_MON1 IS NOT NULL 
    AND F.SALES_FLOW_MON2 IS NOT NULL 
    AND F.SALES_FLOW_MON3 IS NOT NULL
GROUP BY 
    F.SERIES_NAME, F.TOTAL_ASSETS
HAVING 
    F.TOTAL_ASSETS > 0
ORDER BY 
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC
LIMIT 1;",Identify funds with highest portfolio turnover based on their trading activity?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END),
    COUNT(DISTINCT F.SERIES_NAME),
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    LEFT JOIN SECURITIES_LENDING SL 
        ON F.ACCESSION_NUMBER = SL.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME)) DESC
LIMIT 1;",See which fund families are most active in securities lending,False
"SELECT 
    F.SERIES_NAME,
    DC.DERIVATIVE_COUNTERPARTY_NAME,
    COUNT(*),
    COUNT(DISTINCT DC.HOLDING_ID)
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN DERIVATIVE_COUNTERPARTY DC 
        ON H.HOLDING_ID = DC.HOLDING_ID
GROUP BY 
    F.SERIES_NAME, DC.DERIVATIVE_COUNTERPARTY_NAME;",Check for funds with significant counterparty exposure through their derivatives,False
