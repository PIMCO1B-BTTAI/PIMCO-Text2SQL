Ground_Truth_Query,LLM_Query,Comparison_Result
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
<<<<<<< HEAD
LIMIT 20;",Show me the top 20 largest funds by total assets,False
=======
LIMIT 20;",Show me the top 20 largest funds by total assets,Error
>>>>>>> 203dcdef334a2a21b8d46047e2ce5fc213165f86
"SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
<<<<<<< HEAD
    CAST(NET_ASSETS AS FLOAT) > 1000000000;",List all funds with net assets over 1 billion dollars,False
=======
    CAST(NET_ASSETS AS FLOAT) > 1000000000;",List all funds with net assets over 1 billion dollars,Error
>>>>>>> 203dcdef334a2a21b8d46047e2ce5fc213165f86
"SELECT 
    ASSET_CAT,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING
GROUP BY 
    ASSET_CAT
ORDER BY 
    SUM(CAST(CURRENCY_VALUE AS FLOAT)) DESC
<<<<<<< HEAD
LIMIT 1;",Which asset categories have the highest total investment value?,False
=======
LIMIT 1;",Which asset categories have the highest total investment value?,Error
>>>>>>> 203dcdef334a2a21b8d46047e2ce5fc213165f86
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%BOND%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC
<<<<<<< HEAD
LIMIT 1;",Show me the largest bond funds,False
"SELECT 
    REGISTRANT_NAME,
    PHONE 
FROM 
    REGISTRANT 
WHERE 
    REGISTRANT_NAME LIKE '%VANGUARD%';",Show me the phone numbers of all Vanguard registrants,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(TOTAL_ASSETS AS FLOAT) BETWEEN 100000000 AND 500000000;",Which funds have assets between 100M and 500M?,False
"SELECT 
    REGISTRANT_NAME,
    CITY
FROM 
    REGISTRANT;",List all registrants and their cities,True
"SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS = NET_ASSETS;",Which funds have total assets equal to net assets?,True
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INCOME%';",List all funds with 'Income' in their name,False
"SELECT 
    SERIES_NAME,
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    TOTAL_ASSETS != '0'
ORDER BY 
    CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;",Which funds have the highest liabilities to assets ratio?,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%GROWTH%';",Show me all funds with 'Growth' in their name,False
"SELECT 
    SERIES_NAME,
    NET_ASSETS 
FROM 
    FUND_REPORTED_INFO 
ORDER BY 
    CAST(NET_ASSETS AS FLOAT) DESC 
LIMIT 10;",List the top 10 funds by net assets,False
"SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;",Which funds have zero liabilities?,True
"SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) DESC
LIMIT 1;",Which funds have the most cash on hand?,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_ASSETS IS NOT NULL
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) ASC 
LIMIT 5;",Show me the smallest 5 funds by total assets,False
"SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT PHONE)
FROM 
    REGISTRANT
GROUP BY 
    REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT PHONE) > 1;",Which registrants have multiple phone numbers?,False
"SELECT 
    REGISTRANT_NAME,
    CITY,
    ADDRESS1 
FROM 
    REGISTRANT 
WHERE 
    STATE = 'FL';",Show me all registrants from Florida,False
"SELECT 
    SERIES_NAME,
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)
FROM 
    FUND_REPORTED_INFO
WHERE 
    CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL 
    AND TOTAL_ASSETS > 0
ORDER BY 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) DESC
LIMIT 1;",Show me funds with the highest ratio of cash to total assets,False
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    SERIES_NAME LIKE '%INDEX%';",List all funds with 'Index' in their name,False
"SELECT 
    REGISTRANT_NAME,
    ZIP
FROM 
    REGISTRANT;",List all registrants with their ZIP codes,True
"SELECT 
    SERIES_NAME,
    TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%EQUITY%'
    OR SERIES_NAME LIKE '%STOCK%'
ORDER BY 
    CAST(TOTAL_ASSETS AS FLOAT) DESC;",Show me all equity-focused funds,False
"SELECT 
    REGISTRANT_NAME,
    COUNTRY
FROM 
    REGISTRANT;",List all registrants with their country,True
"SELECT 
    COUNT(*),
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO
WHERE 
    SERIES_NAME LIKE '%SUSTAINABLE%'
    OR SERIES_NAME LIKE '%ESG%';",I'm looking for any funds with 'sustainable' or 'ESG' in their name what's their total AUM?,False
"SELECT 
    STATE,
    COUNT(DISTINCT REGISTRANT_NAME)
FROM 
    REGISTRANT
GROUP BY 
    STATE
ORDER BY 
    COUNT(DISTINCT REGISTRANT_NAME) DESC
LIMIT 5;",Could you check which states have the most fund registrants? Top 5 is fine.,False
"SELECT 
    DISTINCT REGISTRANT_NAME
FROM 
    REGISTRANT 
WHERE 
    STATE = 'US-CA';",Which registrants are based in California?,False
"SELECT 
    SERIES_NAME 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    TOTAL_LIABILITIES = '0' 
    OR TOTAL_LIABILITIES IS NULL;",List all funds with no reported liabilities.,False
"SELECT 
    ACCESSION_NUMBER,
    INTRST_RATE_CHANGE_3MON_DV01 
FROM 
    INTEREST_RATE_RISK 
WHERE 
    CAST(INTRST_RATE_CHANGE_3MON_DV01 AS FLOAT) > 1000000;",Show me all interest rate risks with a 3-month DV01 value exceeding 1 million,False
"SELECT 
    CURRENCY_CODE,
    SUM(CAST(CURRENCY_VALUE AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING 
GROUP BY 
    CURRENCY_CODE;",Show the total investment values grouped by currency code.,False
"SELECT 
    NAME,
    AGGREGATE_VALUE 
FROM 
    BORROWER 
WHERE 
    CAST(AGGREGATE_VALUE AS FLOAT) > 200000000;",List all borrowers with an aggregate value over 200 million.,False
"SELECT 
    HOLDING_ID,
    UNREALIZED_APPRECIATION 
FROM 
    NONFOREIGN_EXCHANGE_SWAP 
WHERE 
    CAST(UNREALIZED_APPRECIATION AS FLOAT) > 10000000;",Which funds have unrealized appreciation in nonforeign currency swaps exceeding $10 million?,False
"SELECT 
    SERIES_NAME,
    LIQUIDATION_PREFERENCE 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(LIQUIDATION_PREFERENCE AS FLOAT) > 1000000000;",List all funds with a liquidation preference exceeding $1 billion.,False
"SELECT 
    HOLDING_ID,
    ANNUALIZED_RATE 
FROM 
    DEBT_SECURITY 
WHERE 
    CAST(ANNUALIZED_RATE AS FLOAT) > 5.0;",Show me all debt securities with an annualized rate above 5%.,False
"SELECT 
    ISSUER_NAME,
    BALANCE 
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    CAST(BALANCE AS FLOAT) > 1000;","Show all holding records with a balance over 1,000.",False
"SELECT 
    SERIES_NAME,
    IS_NON_CASH_COLLATERAL 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    IS_NON_CASH_COLLATERAL = 'Y';",Show all funds with non-cash collateral flagged as true.,True
"SELECT 
    REGISTRANT_NAME
FROM 
    REGISTRANT 
WHERE 
    COUNTRY != 'United States';",List all registrants reporting from countries other than the United States.,True
"SELECT 
    ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    ASSET_CAT = 'DBT';",Show all issuers categorized as DBT securities.,False
"SELECT 
    SERIES_NAME
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(REDEMPTION_FLOW_MON2 AS FLOAT) = 0;",Find all funds where redemption flows in the second month are zero.,False
"SELECT 
    SERIES_NAME,
    CASH_NOT_RPTD_IN_C_OR_D,
    TOTAL_LIABILITIES 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) > CAST(TOTAL_LIABILITIES AS FLOAT);",Show all funds with cash not reported exceeding total liabilities.,False
"SELECT 
    ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING 
WHERE 
    IS_RESTRICTED_SECURITY = 'Y';",Show all issuers with restricted securities.,True
"SELECT 
    SERIES_NAME,
    SALES_FLOW_MON2 
FROM 
    FUND_REPORTED_INFO 
WHERE 
    CAST(SALES_FLOW_MON2 AS FLOAT) > 0;",Find all funds where monthly sales flow for the second month is positive.,False
"SELECT 
    REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;",How many funds does each registrant have?,False
"SELECT 
    SUM(CAST(TOTAL_ASSETS AS FLOAT))
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';",What are the total assets of BlackRock funds?,False
"SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;",List all funds with their registrant names,True
"SELECT 
    F.SERIES_NAME,
    MAX(S.FILING_DATE)
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME;",What's the latest filing date for each fund?,False
"SELECT 
    R.REGISTRANT_NAME,
    MIN(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;",Show me the earliest filing date for each registrant,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME),
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;",List all registrants with their fund count and total assets,False
"SELECT 
    F.SERIES_NAME,
    F.TOTAL_ASSETS
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R 
        ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%FIDELITY%';",Show me all Fidelity funds,False
"SELECT 
    R.REGISTRANT_NAME,
    F.TOTAL_ASSETS
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER;",List all registrants with their latest fund's assets,False
"SELECT 
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN SUBMISSION S 
        ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER;",List all funds with their submission dates,True
"SELECT 
    R.REGISTRANT_NAME,
    MAX(S.FILING_DATE)
FROM 
    REGISTRANT R
    JOIN SUBMISSION S 
        ON R.ACCESSION_NUMBER = S.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    MAX(S.FILING_DATE) DESC
LIMIT 1;",Show me the registrants with the most recent filings,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT 
        CASE 
            WHEN F.SERIES_NAME LIKE '%BOND%' THEN 'BOND'
            WHEN F.SERIES_NAME LIKE '%EQUITY%' THEN 'EQUITY'
            WHEN F.SERIES_NAME LIKE '%MONEY MARKET%' THEN 'MONEY MARKET'
            WHEN F.SERIES_NAME LIKE '%INDEX%' THEN 'INDEX'
            WHEN F.SERIES_NAME LIKE '%ETF%' THEN 'ETF'
            ELSE 'OTHER'
        END
    ) AS Fund_Type_Count
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    Fund_Type_Count DESC
LIMIT 1;",Find out which investment firms manage the most diverse portfolio of fund types?,False
"SELECT 
    F.SERIES_NAME,
    H.ISSUER_NAME,
    H.PERCENTAGE
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    CAST(H.PERCENTAGE AS FLOAT) > 10.0;",I need to check which funds may be too concentrated - find ones where a single holding is more than 10% of their portfolio?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(DISTINCT H.INVESTMENT_COUNTRY),
    COUNT(DISTINCT H.HOLDING_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.INVESTMENT_COUNTRY IS NOT NULL
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) DESC
LIMIT 1;",Check which investment firms have the most diverse geographic exposure in their holdings,False
"SELECT 
    SERIES_NAME,
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT),
    CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    CAST(INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 1.0
    OR CAST(INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 1.0;",Find me funds that might be too exposed to interest rate changes - check their duration risk,False
"SELECT 
    F.SERIES_NAME,
    M.MONTHLY_TOTAL_RETURN1,
    M.MONTHLY_TOTAL_RETURN2,
    M.MONTHLY_TOTAL_RETURN3,
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3
FROM 
    FUND_REPORTED_INFO F
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) > 0
    AND CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT) > 0
ORDER BY 
    (CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN2 AS FLOAT) + 
     CAST(M.MONTHLY_TOTAL_RETURN3 AS FLOAT)) / 3 DESC;",I need to find funds with strong and consistent returns over all three months,Error
"SELECT 
    H.ASSET_CAT,
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT))
FROM 
    FUND_REPORTED_HOLDING H
    JOIN FUND_REPORTED_INFO F 
        ON H.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN MONTHLY_TOTAL_RETURN M 
        ON F.ACCESSION_NUMBER = M.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    H.ASSET_CAT
ORDER BY 
    AVG(CAST(M.MONTHLY_TOTAL_RETURN1 AS FLOAT)) DESC
LIMIT 1;",Show me which asset categories had the best returns last month?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END),
    COUNT(*),
    SUM(CASE WHEN H.INVESTMENT_COUNTRY != 'US' 
        THEN CAST(H.CURRENCY_VALUE AS FLOAT) ELSE 0 END)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    COUNT(*) > 10
ORDER BY 
    COUNT(CASE WHEN H.INVESTMENT_COUNTRY != 'US' THEN 1 END) DESC
LIMIT 1;",Which investment companies are most exposed to international markets?,False
"SELECT 
    F.SERIES_NAME,
    H.ASSET_CAT,
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H 
        ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
WHERE 
    H.ASSET_CAT IS NOT NULL
GROUP BY 
    F.SERIES_NAME, H.ASSET_CAT, F.TOTAL_ASSETS
ORDER BY 
    CAST(SUM(H.CURRENCY_VALUE) AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) * 100 DESC;",Help me find funds that might be too concentrated in specific sectors,False
"SELECT 
    F.SERIES_NAME,
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT)
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) + CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) DESC
LIMIT 1;",Which funds are taking on the most interest rate risk?,False
"SELECT 
    F.SERIES_NAME,
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100
FROM 
    FUND_REPORTED_INFO F
WHERE 
    F.SALES_FLOW_MON1 IS NOT NULL 
    AND F.SALES_FLOW_MON2 IS NOT NULL 
    AND F.SALES_FLOW_MON3 IS NOT NULL
GROUP BY 
    F.SERIES_NAME, F.TOTAL_ASSETS
HAVING 
    F.TOTAL_ASSETS > 0
ORDER BY 
    (SUM(CAST(F.SALES_FLOW_MON1 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON2 AS FLOAT) + 
         CAST(F.SALES_FLOW_MON3 AS FLOAT)) / NULLIF(CAST(F.TOTAL_ASSETS AS FLOAT), 0)) * 100 DESC
LIMIT 1;",Identify funds with highest portfolio turnover based on their trading activity?,Error
"SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    LEFT JOIN SECURITIES_LENDING SL 
        ON F.ACCESSION_NUMBER = SL.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    (COUNT(DISTINCT CASE WHEN SL.IS_LOAN_BY_FUND = 'Y' THEN F.SERIES_NAME END) * 100.0 / COUNT(DISTINCT F.SERIES_NAME)) DESC
LIMIT 1;",See which fund families are most active in securities lending,False
"SELECT 
    REGISTRANT_NAME,
    COUNT(DISTINCT SERIES_NAME),
    COUNT(DISTINCT SERIES_ID)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F 
        ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    REGISTRANT_NAME;",How many funds does each investment company manage?,False
"SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN INTEREST_RATE_RISK IR 
        ON F.ACCESSION_NUMBER = IR.ACCESSION_NUMBER
WHERE 
    IR.CURRENCY_CODE = 'USD'
    AND (
        CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) > 100000
        OR CAST(IR.INTRST_RATE_CHANGE_30YR_DV01 AS FLOAT) > 100000
    )
ORDER BY 
    CAST(IR.INTRST_RATE_CHANGE_10YR_DV01 AS FLOAT) DESC
LIMIT 1;",Which USD funds are most exposed to interest rate changes?,False
"SELECT 
    R.STATE,
    SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.STATE IS NOT NULL
GROUP BY 
    R.STATE;",What's our exposure by state? Need to check geographic concentration.,False
"SELECT 
    H.ISSUER_NAME
FROM 
    FUND_REPORTED_HOLDING H
    JOIN SECURITIES_LENDING SL ON H.HOLDING_ID = SL.HOLDING_ID
WHERE 
    SL.IS_LOAN_BY_FUND = 'Y'
GROUP BY 
    H.ISSUER_NAME
HAVING 
    COUNT(*) > 1
ORDER BY 
    COUNT(*) DESC,
    SUM(CAST(H.CURRENCY_VALUE AS FLOAT)) DESC
LIMIT 1;",Which securities are most actively lent out?,False
"SELECT 
    F.SERIES_NAME,
    CSC.CONVERSION_RATIO
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
    JOIN CONVERTIBLE_SECURITY_CURRENCY CSC ON H.HOLDING_ID = CSC.HOLDING_ID
WHERE 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) > 1
ORDER BY 
    CAST(CSC.CONVERSION_RATIO AS FLOAT) DESC;",Let's look at convertible securities with high conversion ratios - could be significant upside.,False
"SELECT
    h.ISSUER_TYPE,
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*))
FROM 
    FUND_REPORTED_HOLDING h
    JOIN DEBT_SECURITY d ON h.HOLDING_ID = d.HOLDING_ID
WHERE 
    h.ISSUER_TYPE IS NOT NULL
GROUP BY 
    h.ISSUER_TYPE
ORDER BY 
    (COUNT(CASE WHEN d.ARE_ANY_INTEREST_PAYMENT = 'Y' THEN 1 END) * 100.0 / COUNT(*)) DESC;",What percentage of bonds have missed interest payments by sector?,False
"SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME,
    S.FILING_DATE
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
    JOIN SUBMISSION S ON F.ACCESSION_NUMBER = S.ACCESSION_NUMBER
ORDER BY 
    S.FILING_DATE DESC;","List all funds and their associated registrants, sorted by filing date",False
"SELECT 
    R.STATE,
    AVG(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.STATE IS NOT NULL
GROUP BY 
    R.STATE;",What are the average total assets per state?,False
"SELECT 
    F.SERIES_NAME,
    R.REGISTRANT_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    R.STATE = 'US-CA';",List all funds managed by registrants in California.,False
"SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_HOLDING F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN CONVERTIBLE_SECURITY_CURRENCY CSC ON F.HOLDING_ID = CSC.HOLDING_ID
GROUP BY 
    R.REGISTRANT_NAME
ORDER BY 
    COUNT(CSC.CONVERTIBLE_SECURITY_ID) DESC
LIMIT 1;",Which registrants are most active in convertible securities?,True
"SELECT 
    R.REGISTRANT_NAME,
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE 
    F.IS_NON_CASH_COLLATERAL = 'Y';",Show funds exposed to non-cash collateral.,False
"SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY 
    COUNT(H.HOLDING_ID) DESC
LIMIT 1;",Which funds have the highest number of holdings?,False
"SELECT 
    F.SERIES_NAME,
    F.TOTAL_LIABILITIES
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    R.REGISTRANT_NAME LIKE '%BLACKROCK%';",List all funds managed by BlackRock and their total liabilities.,False
"SELECT 
    F.SERIES_NAME,
    COUNT(DISTINCT R.REGISTRANT_NAME) AS REGISTRANT_COUNT
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
HAVING 
    COUNT(DISTINCT R.REGISTRANT_NAME) > 1;",Identify funds managed by multiple registrants.,False
"SELECT 
    F.SERIES_NAME
FROM 
    FUND_REPORTED_INFO F
    JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
GROUP BY 
    F.SERIES_NAME
ORDER BY
		MAX(CAST(F.BORROWING_PAY_WITHIN_1YR AS FLOAT)) DESC
LIMIT 1;",Which funds reported the highest borrowing within one year?,True
"SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    JOIN FUND_REPORTED_HOLDING H ON F.ACCESSION_NUMBER = H.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME
HAVING 
    COUNT(DISTINCT H.INVESTMENT_COUNTRY) > 1;",Find registrants with securities in multiple countries.,True
"SELECT 
    R.REGISTRANT_NAME
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE 
    F.TOTAL_LIABILITIES = '0'
GROUP BY 
    R.REGISTRANT_NAME;",Which registrants have zero liabilities but manage funds?,False
"SELECT 
    R.REGISTRANT_NAME,
    COUNT(F.SERIES_NAME)
FROM 
    REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY 
    R.REGISTRANT_NAME;",List all registrants along with the number of funds they manage.,False
"WITH AvgAssets AS (
    SELECT AVG(CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_TOTAL_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_ASSETS AS FLOAT) > (SELECT AVG_TOTAL_ASSETS FROM AvgAssets);",Find funds whose total assets exceed the average total assets of all funds.,False
"WITH AvgFundCount AS (
    SELECT AVG(FUND_COUNT) AS AVG_COUNT
    FROM (SELECT REGISTRANT_NAME, COUNT(*) AS FUND_COUNT FROM REGISTRANT R
          JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
          GROUP BY REGISTRANT_NAME) Subquery
)
SELECT REGISTRANT_NAME, COUNT(*)
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY REGISTRANT_NAME
HAVING COUNT(*) > (SELECT AVG_COUNT FROM AvgFundCount)
ORDER BY COUNT(*) DESC
LIMIT 5;","List the top 5 registrants by fund count, excluding those with below-average counts.",False
"WITH AvgLiabilities AS (
    SELECT AVG(CAST(TOTAL_LIABILITIES AS FLOAT)) AS AVG_LIABILITY
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > 2 * (SELECT AVG_LIABILITY FROM AvgLiabilities);",Show funds whose liabilities are more than twice the average liability of all funds.,False
"WITH StateFundCount AS (
    SELECT STATE, COUNT(*) AS FUND_COUNT
    FROM REGISTRANT
    GROUP BY STATE
)
SELECT REGISTRANT_NAME, STATE
FROM REGISTRANT
WHERE STATE = (SELECT STATE FROM StateFundCount ORDER BY FUND_COUNT DESC LIMIT 1);",Identify registrants whose states have the most funds.,Error
"WITH StateMaxAssets AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT SERIES_NAME, TOTAL_ASSETS, STATE
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM StateMaxAssets WHERE STATE = R.STATE);",Find funds whose total assets match the maximum total assets of their registrant's state.,Error
"WITH TotalAssets AS (
    SELECT SUM(CAST(TOTAL_ASSETS AS FLOAT)) AS GLOBAL_TOTAL
    FROM FUND_REPORTED_INFO
)
SELECT REGISTRANT_NAME, SUM(CAST(F.TOTAL_ASSETS AS FLOAT))
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
GROUP BY REGISTRANT_NAME
HAVING SUM(CAST(F.TOTAL_ASSETS AS FLOAT)) > 0.05 * (SELECT GLOBAL_TOTAL FROM TotalAssets);",List the registrants whose funds account for more than 5% of total reported assets.,Error
"WITH LargestFunds AS (
    SELECT REGISTRANT_NAME, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, SERIES_NAME, TOTAL_ASSETS
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM LargestFunds WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);",Find the largest fund for each registrant.,Error
"WITH MaxLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_LIABILITY
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > 0.9 * (SELECT MAX_LIABILITY FROM MaxLiability);",Show funds with liabilities exceeding 90% of the largest liability among all funds.,Error
"WITH MaxNetAssets AS (
    SELECT REGISTRANT_NAME, MAX(CAST(NET_ASSETS AS FLOAT)) AS MAX_NET_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT SERIES_NAME, NET_ASSETS
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(NET_ASSETS AS FLOAT) = (SELECT MAX_NET_ASSETS FROM MaxNetAssets WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);",List funds whose net assets match their registrant's highest net asset fund.,Error
"WITH StateAvgAssets AS (
    SELECT STATE, AVG(CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_STATE_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) > (SELECT AVG_STATE_ASSETS FROM StateAvgAssets WHERE STATE = R.STATE);",List registrants with above-average total assets in their state.,Error
"WITH MaxBondLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_BOND_LIABILITY FROM MaxBondLiability);",Identify funds whose liabilities exceed the largest liability for any bond fund.,Error
"WITH LargestFundPerState AS (
    SELECT R.STATE, MAX(CAST(F.TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM LargestFundPerState WHERE STATE = R.STATE);",Show registrants managing the largest fund in each state.,Error
"WITH SmallestFunds AS (
    SELECT REGISTRANT_NAME, MIN(CAST(TOTAL_ASSETS AS FLOAT)) AS MIN_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MIN_ASSETS FROM SmallestFunds WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);",Find the smallest fund for each registrant.,Error
"WITH RegistrantAvgCash AS (
    SELECT REGISTRANT_NAME, AVG(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS AVG_CASH
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) > (SELECT AVG_CASH FROM RegistrantAvgCash WHERE REGISTRANT_NAME = R.REGISTRANT_NAME);",List funds whose cash exceeds the average cash for their registrant.,Error
"WITH AvgRegistrantsPerState AS (
    SELECT AVG(REG_COUNT) AS AVG_COUNT
    FROM (SELECT STATE, COUNT(*) AS REG_COUNT FROM REGISTRANT GROUP BY STATE) Subquery
)
SELECT STATE
FROM REGISTRANT
GROUP BY STATE
HAVING COUNT(*) > (SELECT AVG_COUNT FROM AvgRegistrantsPerState);",Show states with above-average registrant counts.,Error
"WITH MaxEquityNetAssets AS (
    SELECT MAX(CAST(NET_ASSETS AS FLOAT)) AS MAX_NET_ASSETS
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%'
)
SELECT SERIES_NAME, NET_ASSETS
FROM FUND_REPORTED_INFO
WHERE CAST(NET_ASSETS AS FLOAT) > (SELECT MAX_NET_ASSETS FROM MaxEquityNetAssets);",Find funds with net assets exceeding the maximum for equity funds.,Error
"WITH LargestFund AS (
    SELECT MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_TOTAL_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_TOTAL_ASSETS FROM LargestFund);",List registrants managing the largest fund across all registrants.,Error
"WITH MinBondLiability AS (
    SELECT MIN(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MIN_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) < (SELECT MIN_BOND_LIABILITY FROM MinBondLiability);",Identify funds with liabilities less than the smallest liability for bond funds.,Error
"WITH StateLargestFund AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY STATE
)
SELECT R.STATE, F.SERIES_NAME, F.TOTAL_ASSETS
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_ASSETS AS FLOAT) = (SELECT MAX_ASSETS FROM StateLargestFund WHERE STATE = R.STATE);",Find the largest fund in each state.,Error
"WITH CashPercentage AS (
    SELECT SERIES_NAME, (CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE CASH_NOT_RPTD_IN_C_OR_D IS NOT NULL AND CAST(TOTAL_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, CASH_RATIO
FROM CashPercentage
WHERE CASH_RATIO > 0.2;",Show funds with a percentage of their portfolio in cash exceeding 20%.,Error
"WITH AvgRedemptionFlow AS (
    SELECT AVG(CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) AS AVG_FLOW
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, REDEMPTION_FLOW_MON1, REDEMPTION_FLOW_MON2, REDEMPTION_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) > (SELECT AVG_FLOW FROM AvgRedemptionFlow);",Identify funds with above-average monthly redemption flows.,Error
"WITH LargestFundPerRegistrant AS (
    SELECT REGISTRANT_NAME, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, MAX_ASSETS
FROM LargestFundPerRegistrant
WHERE MAX_ASSETS > 1000000000;",Find registrants whose largest fund exceeds $1 billion in total assets.,Error
"WITH MinBondFundLiability AS (
    SELECT MIN(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MIN_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) < (SELECT MIN_LIABILITY FROM MinBondFundLiability);",Show funds with liabilities smaller than the smallest liability of any bond fund.,Error
"WITH RegistrantsWithLargeFunds AS (
    SELECT REGISTRANT_NAME
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
    HAVING MAX(CAST(F.TOTAL_ASSETS AS FLOAT)) > 500000000
)
SELECT R.REGISTRANT_NAME, SUM(CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT)) AS TOTAL_CASH
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE R.REGISTRANT_NAME IN (SELECT REGISTRANT_NAME FROM RegistrantsWithLargeFunds)
GROUP BY R.REGISTRANT_NAME;",Find the total cash held by registrants whose largest fund exceeds $500 million.,Error
"WITH MaxEquityCashRatio AS (
    SELECT MAX(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_EQUITY_CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%'
)
SELECT SERIES_NAME, CASH_NOT_RPTD_IN_C_OR_D, TOTAL_ASSETS
FROM FUND_REPORTED_INFO
WHERE CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT) > (SELECT MAX_EQUITY_CASH_RATIO FROM MaxEquityCashRatio);",List funds that have a greater percentage of cash compared to any equity fund.,Error
"WITH AvgNetAssets AS (
    SELECT AVG(CAST(NET_ASSETS AS FLOAT)) AS AVG_NET_ASSETS
    FROM FUND_REPORTED_INFO
)
SELECT R.STATE, COUNT(*) AS REGISTRANT_COUNT
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.NET_ASSETS AS FLOAT) > (SELECT AVG_NET_ASSETS FROM AvgNetAssets)
GROUP BY R.STATE
HAVING COUNT(*) > 10;",Identify states with more than 10 registrants having net assets above the average.,Error
"WITH PortfolioTurnover AS (
    SELECT REGISTRANT_NAME, 
           MAX((CAST(F.SALES_FLOW_MON1 AS FLOAT) + CAST(F.SALES_FLOW_MON2 AS FLOAT) + CAST(F.SALES_FLOW_MON3 AS FLOAT)) 
               / CAST(F.TOTAL_ASSETS AS FLOAT)) AS TURNOVER_RATIO
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY REGISTRANT_NAME
)
SELECT REGISTRANT_NAME, TURNOVER_RATIO
FROM PortfolioTurnover
ORDER BY TURNOVER_RATIO DESC
LIMIT 1;",Show registrants with the largest portfolio turnover ratio.,Error
"WITH AvgBondLiability AS (
    SELECT AVG(CAST(TOTAL_LIABILITIES AS FLOAT)) AS AVG_BOND_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, TOTAL_LIABILITIES
FROM FUND_REPORTED_INFO
WHERE CAST(TOTAL_LIABILITIES AS FLOAT) > (SELECT AVG_BOND_LIABILITY FROM AvgBondLiability);",Find funds whose liabilities are larger than the average liabilities of bond funds.,Error
"WITH VanguardLargestFund AS (
    SELECT STATE, MAX(CAST(TOTAL_ASSETS AS FLOAT)) AS MAX_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE R.REGISTRANT_NAME LIKE '%VANGUARD%'
    GROUP BY STATE
)
SELECT STATE, MAX_ASSETS
FROM VanguardLargestFund;",Identify states where the largest fund is managed by Vanguard.,Error
"WITH LiabilityToNetAssets AS (
    SELECT SERIES_NAME, 
           (CAST(TOTAL_LIABILITIES AS FLOAT) / CAST(NET_ASSETS AS FLOAT)) AS LIABILITY_RATIO
    FROM FUND_REPORTED_INFO
    WHERE CAST(NET_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, LIABILITY_RATIO
FROM LiabilityToNetAssets
WHERE SERIES_NAME != 'N/A'
ORDER BY LIABILITY_RATIO DESC
LIMIT 1;",Find exisiting funds with the highest proportion of liabilities to net assets.,Error
"WITH MaxETFSalesFlow AS (
    SELECT MAX(CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) AS MAX_ETF_FLOW
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%ETF%'
)
SELECT SERIES_NAME, SALES_FLOW_MON1, SALES_FLOW_MON2, SALES_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) > (SELECT MAX_ETF_FLOW FROM MaxETFSalesFlow);",Identify funds with monthly sales flows larger than any ETF.,Error
"WITH AvgEquityCashRatio AS (
    SELECT AVG(CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) AS AVG_CASH_RATIO
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%EQUITY%' AND CAST(TOTAL_ASSETS AS FLOAT) > 0
)
SELECT SERIES_NAME, CASH_NOT_RPTD_IN_C_OR_D, TOTAL_ASSETS
FROM FUND_REPORTED_INFO
WHERE (CAST(CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(TOTAL_ASSETS AS FLOAT)) > (SELECT AVG_CASH_RATIO FROM AvgEquityCashRatio);",Identify funds whose cash proportion is higher than the average cash proportion of equity funds.,Error
"WITH MaxConvertibleLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_CONVERTIBLE_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%CONVERTIBLE%'
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_LIABILITIES
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_CONVERTIBLE_LIABILITY FROM MaxConvertibleLiability);",Show registrants managing funds with liabilities higher than any convertible security fund.,Error
"WITH AvgSalesFlow AS (
    SELECT AVG(CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) AS AVG_SALES_FLOW
    FROM FUND_REPORTED_INFO
)
SELECT SERIES_NAME, SALES_FLOW_MON1, SALES_FLOW_MON2, SALES_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(SALES_FLOW_MON1 AS FLOAT) + CAST(SALES_FLOW_MON2 AS FLOAT) + CAST(SALES_FLOW_MON3 AS FLOAT)) > (SELECT AVG_SALES_FLOW FROM AvgSalesFlow);",List funds with monthly sales flows higher than the average for all funds.,Error
"WITH AvgStateLiability AS (
    SELECT R.STATE, AVG(CAST(F.TOTAL_LIABILITIES AS FLOAT)) AS AVG_LIABILITY
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT F.SERIES_NAME, F.TOTAL_LIABILITIES, R.STATE
FROM FUND_REPORTED_INFO F
JOIN REGISTRANT R ON F.ACCESSION_NUMBER = R.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) < (SELECT AVG_LIABILITY FROM AvgStateLiability WHERE STATE = R.STATE);",Find funds with liabilities less than the average liabilities of all funds in their state.,Error
"WITH StateMaxCash AS (
    SELECT R.STATE, MAX(CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT)) AS MAX_CASH_RATIO
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE CAST(F.TOTAL_ASSETS AS FLOAT) > 0
    GROUP BY R.STATE
)
SELECT R.REGISTRANT_NAME, R.STATE, F.SERIES_NAME, F.CASH_NOT_RPTD_IN_C_OR_D
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.CASH_NOT_RPTD_IN_C_OR_D AS FLOAT) / CAST(F.TOTAL_ASSETS AS FLOAT) = 
      (SELECT MAX_CASH_RATIO FROM StateMaxCash WHERE STATE = R.STATE);",Identify registrants managing funds with the highest cash proportion in their state.,Error
"WITH AvgStateLiability AS (
    SELECT R.STATE, AVG(CAST(F.TOTAL_LIABILITIES AS FLOAT)) AS AVG_STATE_LIABILITY
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    GROUP BY R.STATE
)
SELECT STATE
FROM AvgStateLiability
WHERE AVG_STATE_LIABILITY > (SELECT AVG(AVG_STATE_LIABILITY) FROM AvgStateLiability);",Find states with total liabilities higher than the average liabilities for all states.,Error
"WITH MaxIndexFundLiability AS (
    SELECT MAX(CAST(TOTAL_LIABILITIES AS FLOAT)) AS MAX_INDEX_LIABILITY
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%INDEX%'
)
SELECT R.REGISTRANT_NAME, F.SERIES_NAME, F.TOTAL_LIABILITIES
FROM REGISTRANT R
JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
WHERE CAST(F.TOTAL_LIABILITIES AS FLOAT) > (SELECT MAX_INDEX_LIABILITY FROM MaxIndexFundLiability);",Show registrants managing funds with liabilities larger than the maximum liabilities of any index fund.,Error
"WITH MaxBondRedemptionFlow AS (
    SELECT MAX(CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) AS MAX_BOND_FLOW
    FROM FUND_REPORTED_INFO
    WHERE SERIES_NAME LIKE '%BOND%'
)
SELECT SERIES_NAME, REDEMPTION_FLOW_MON1, REDEMPTION_FLOW_MON2, REDEMPTION_FLOW_MON3
FROM FUND_REPORTED_INFO
WHERE (CAST(REDEMPTION_FLOW_MON1 AS FLOAT) + CAST(REDEMPTION_FLOW_MON2 AS FLOAT) + CAST(REDEMPTION_FLOW_MON3 AS FLOAT)) > (SELECT MAX_BOND_FLOW FROM MaxBondRedemptionFlow);",Find funds whose redemption flows exceed the highest redemption flow for any bond fund.,Error
"WITH StateAvgNetAssets AS (
    SELECT R.STATE, AVG(CAST(F.NET_ASSETS AS FLOAT)) AS AVG_NET_ASSETS
    FROM REGISTRANT R
    JOIN FUND_REPORTED_INFO F ON R.ACCESSION_NUMBER = F.ACCESSION_NUMBER
    WHERE F.NET_ASSETS IS NOT NULL
    GROUP BY R.STATE
)
SELECT STATE, AVG_NET_ASSETS
FROM StateAvgNetAssets
WHERE AVG_NET_ASSETS = (SELECT MAX(AVG_NET_ASSETS) FROM StateAvgNetAssets);",List states with the highest average net assets per fund.,Error
=======
LIMIT 1;",Show me the largest bond funds,Error
>>>>>>> 203dcdef334a2a21b8d46047e2ce5fc213165f86
